"use strict";function ActiveGridMaster(){return void 0!==ActiveGridMaster.prototype.singleton?ActiveGridMaster.prototype.singleton:(ActiveGridMaster.prototype.singleton=this,this.delegation=[],this.data=null,this.controlling=null,void(this.components=[]))}function ActiveGridComponent(a){return this.name="",this.data={},this.initialised=!1,this.master=new ActiveGridMaster,this._prepare=null,this._renew=null,void 0!==a?this.init(a):void 0}function getAGDataFromUrl(a){var b="";if(-1!==a.indexOf("?")){var c=a.substring(a.indexOf("?")+1);c=-1!==c.indexOf("#")?c.substring(0,c.indexOf("#")):c;var d=a.substring(0,a.indexOf("?"));d=0===d.indexOf("/")?d.substring(1):d,d=d.indexOf(".php")===d.length-4?d.substring(0,d.length-4):d,b=c+"&page="+d}return b}ActiveGridMaster.prototype.delegate=function(a){for(var b=[],c=0,d=this.delegation.length;d>c;c+=1)if(this.delegation[c].name===this.controlling){b=this.delegation[c].order;break}if(0===b.length)for(var e=0,f=this.components.length;f>e;e+=1)this.components[e].renew(a);else{this.data=a;for(var g=0,h=b.length;h>g;g+=1){var i=this.findComponentByName(b[g]);i instanceof ActiveGridComponent&&i.renew()}}},ActiveGridMaster.prototype.addDelegation=function(a,b){if("object"==typeof a&&"name"in a&&"order"in a&&(b=a.order,a=a.name),void 0!==a&&void 0!==b&&"string"==typeof a){for(var c=-1,d=0,e=this.delegation.length;e>d;d+=1)if(this.delegation[d].name===a){c=d;break}return-1===c?this.delegation.push({name:a,order:b}):this.delegation[d].order=b,!0}return!1},ActiveGridMaster.prototype.findComponentIdByName=function(a){for(var b=-1,c=0,d=this.components.length;d>c;c+=1)if(this.components[c].name===a){b=c;break}return b},ActiveGridMaster.prototype.findComponentByName=function(a){var b=this.findComponentIdByName(a);return-1!==b?this.components[b]:null},ActiveGridMaster.prototype.prepare=function(a){var b=this.findComponentByName(a);return b instanceof ActiveGridComponent?b.prepare():!1},ActiveGridMaster.prototype.prepareAll=function(){for(var a=0,b=this.components.length;b>a;a+=1)this.components[a].prepare()},ActiveGridMaster.prototype.add=function(a){if(a instanceof ActiveGridComponent){if(null!==a.name&&-1===this.findComponentIdByName(a.name))return this.components.push(a),!0}else{var b=new ActiveGridComponent(a);if(null!==b&&-1===this.findComponentIdByName(b.name))return this.components.push(b),!0}return!1},ActiveGridMaster.prototype.fallback=function(a){this.findComponentByName(this.controlling).fallback(a)},ActiveGridMaster.prototype.assignControlling=function(a){return a instanceof ActiveGridComponent?-1!==this.findComponentIdByName(a.name)?(this.controlling=a.name,!0):!1:"string"==typeof a&&-1!==this.findComponentIdByName(a)?(this.controlling=a,!0):!1},ActiveGridComponent.prototype.init=function(a){var b=this;return"name"in a?(-1!==this.master.findComponentIdByName(a.name)&&(b=this.master.findComponentByName(a.name)),b.name=a.name,"prepare"in a&&b.setPrepare(a.prepare),"renew"in a&&b.setRenew(a.renew),"fallback"in a&&b.setFallback(a.fallback),b):null},ActiveGridComponent.prototype.setRenew=function(a){return void 0!==a&&"function"==typeof a?(this._renew=a,!0):!1},ActiveGridComponent.prototype.setPrepare=function(a){return void 0!==a&&"function"==typeof a?(this._prepare=a,!0):!1},ActiveGridComponent.prototype.setFallback=function(a){return void 0!==a&&"function"==typeof a?(this._fallback=a,!0):!1},ActiveGridComponent.prototype.renew=function(){return null!==this._renew?(this._renew(),!0):!1},ActiveGridComponent.prototype.fallback=function(a){return null!==this._fallback?(this._fallback(a),!0):!1},ActiveGridComponent.prototype.prepare=function(){return null!==this._prepare?(this._prepare(),this.initialised=!0,!0):!1};