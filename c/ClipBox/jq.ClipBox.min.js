"use strict";function ClipBox(a){this.element=null,this.container=null,this.angle=90,this.constrainParent=!0,this._determineInnerWidth=null,this._determineInnerHeight=null,this._determineOuterWidth=null,this._determineOuterHeight=null,this.outer={width:0,height:0},this.inner={width:0,height:0},this.working=new CoordinatesBox;var b=this.init(a);return b?($(this.element).css("visibility","visible"),this):((new IMDebugger).pass("Unable to initialise ClipBox"),!1)}function CoordinatesBox(){this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.requiresAlteration=!1,this.x=0,this.y=0}ClipBox.prototype.init=function(a){if(isHTMLElement(a))this.element=this.checkElement(a);else if("object"==typeof a){if("direction"in a)switch(a.direction){case"ttb":this.angle=0;break;case"bbt":this.angle=180;break;case"rtl":this.angle=270;break;case"ltr":case"default":this.angle=90}else"angle"in a&&!isNaN(parseFloat(a.angle))&&isFinite(a.angle)&&(this.angle=simplifyDegrees(a.angle));this.constrainParent="constrainParent"in a&&a.constrainParent?!0:!1,this.element="element"in a&&isHTMLElement(a.element)?this.checkElement(a.element):null,this.container="container"in a&&isHTMLElement(a.container)?a.container:null,this._determineInnerWidth="determineInnerWidth"in a&&"function"==typeof a.determineInnerWidth?a.determineInnerWidth:null,this._determineInnerHeight="determineInnerHeight"in a&&"function"==typeof a.determineInnerHeight?a.determineInnerHeight:null,this._determineOuterWidth="determineOuterWidth"in a&&"function"==typeof a.determineOuterWidth?a.determineOuterWidth:null,this._determineOuterHeight="determineOuterHeight"in a&&"function"==typeof a.determineOuterHeight?a.determineOuterHeight:null}else if("string"==typeof a){var b=$(a);b.length>0&&isHTMLElement(b[0])&&(this.element=this.checkElement(b[0]))}return null!==this.element?(this.container=null===this.container?$(this.element).parent()[0]:this.container,this.determineInnerWidth(),this.determineInnerHeight(),this.determineOuterWidth(),this.determineOuterHeight(),!0):!1},ClipBox.prototype.initialised=function(){return 0===this.outer.width||0===this.outer.height||0===this.inner.width||0===this.inner.height?!1:!0},ClipBox.prototype.move=function(a){a=convertToPixelNumber(a);var b={left:convertToPixelNumber($(this.element).css("left")),top:convertToPixelNumber($(this.element).css("top"))},c=calculateAngledDistance(this.angle,a);b.left+=c.x,b.top+=c.y,this.reposition(b)},ClipBox.prototype.determine=function(){if(this.initialised()){this.working=new CoordinatesBox;var a={top:convertToPixelNumber($(this.element).css("top")),right:convertToPixelNumber($(this.element).css("right")),bottom:convertToPixelNumber($(this.element).css("bottom")),left:convertToPixelNumber($(this.element).css("left"))},b={top:a.top,left:a.left};this.reposition(b)}},ClipBox.prototype.reposition=function(a){if(this.initialised()){this.working=new CoordinatesBox,this.working.x2=this.outer.width,this.working.y2=this.outer.height;var b={top:0,left:0};if($.isArray(a)){var c={};if(4===a.length)c={top:convertToPixelNumber(a[0]),right:convertToPixelNumber(a[1]),bottom:convertToPixelNumber(a[2]),left:convertToPixelNumber(a[3])};else if(a.length%2===0&&a.length<9)for(var d=0;d<a.length;){var e=a[d],f=convertToPixelNumber(a[d+1]);c[e]=f,d+=1}a=c}return"object"==typeof a&&("right"in a&&(b.left-=convertToPixelNumber(a.right)),"left"in a&&(b.left+=convertToPixelNumber(a.left)),"bottom"in a&&(b.top-=convertToPixelNumber(a.bottom)),"top"in a&&(b.top+=convertToPixelNumber(a.top))),this.setVertical(b.top),this.setHorizontal(b.left),this.setClip(),this.setXY(),!0}return(new IMDebugger).pass("ClipBox is not properly initialised. Aborting"),!1},ClipBox.prototype.setHorizontal=function(a){this.working.x1=a,this.inner.width<this.outer.width?(this.working.x1=0,this.working.x2=this.inner.width):(this.working.x2=this.working.x1+this.inner.width,this.working.x2<this.outer.width?(this.working.x2=this.outer.width,this.working.x1=this.working.x2-this.inner.width):this.working.x1>0&&(this.working.x1=0,this.working.x2=this.working.x1+this.inner.width)),this.working.x1<0&&(this.working.x=this.working.x1,this.working.x1=Math.abs(this.working.x1),this.working.x2+=this.working.x1)},ClipBox.prototype.setVertical=function(a){this.working.y1=a,this.inner.height<this.outer.height?(this.working.y1=0,this.working.y2=this.inner.height):(this.working.y2=this.working.y1+this.inner.height,this.working.y2<this.outer.height?(this.working.y2=this.outer.height,this.working.y1=this.working.y2-this.inner.height):this.working.y1>0&&(this.working.y1=0,this.working.y2=this.working.y1+this.inner.height)),this.working.y1<0&&(this.working.y=this.working.y1,this.working.y1=Math.abs(this.working.y1),this.working.y2+=this.working.y1)},ClipBox.prototype.checkElement=function(a){var b="relative"===$(a).parent().css("position")||"absolute"===$(a).parent().css("position")?!0:!1,c="absolute"===$(a).css("position")||"relative"===$(a).css("position")?!0:!1,d="hidden"===$(a).css("visibility")?!0:!1;return b&&c&&d?a:null},ClipBox.prototype.parseClip=function(){var a=$(this.element).css("clip"),b={top:0,right:0,bottom:0,left:0};if(0===a.indexOf("rect(")){a=a.substring(5),a=a.substring(0,a.length-1);var c=[];-1!==a.indexOf(", ")?c=a.split(", "):-1!==a.indexOf(",")?c=a.split(","):-1!==a.indexOf(" ")&&(c=a.split(" ")),4===c.length&&(b.top=convertToPixelNumber(c[0]),b.right=convertToPixelNumber(c[1]),b.bottom=convertToPixelNumber(c[2]),b.left=convertToPixelNumber(c[3]))}return b},ClipBox.prototype.determineOuterWidth=function(){this.outer.width=convertToPixelNumber("function"==typeof this._determineOuterWidth?this._determineOuterWidth():$(this.container).innerWidth())},ClipBox.prototype.determineOuterHeight=function(){this.outer.height=convertToPixelNumber("function"==typeof this._determineOuterHeight?this._determineOuterHeight():$(this.container).innerHeight())},ClipBox.prototype.determineInnerWidth=function(){this.inner.width=convertToPixelNumber("function"==typeof this._determineInnerWidth?this._determineInnerWidth():$(this.element).outerWidth())},ClipBox.prototype.determineInnerHeight=function(){this.inner.height=convertToPixelNumber("function"==typeof this._determineInnerHeight?this._determineInnerHeight():$(this.element).outerHeight())},ClipBox.prototype.handleValue=function(a){return 0===a?"auto":a+"px"},ClipBox.prototype.setClip=function(){$(this.element).css("clip","rect("+this.handleValue(this.working.y1)+" "+this.handleValue(this.working.x2)+" "+this.handleValue(this.working.y2)+" "+this.handleValue(this.working.x1)+")"),this.constrainParent&&($(this.element).parent().css("width",this.working.x2-this.working.x1+"px"),$(this.element).parent().css("height",this.working.y2-this.working.y1+"px"))},ClipBox.prototype.setXY=function(){var a=this.working.x,b=this.working.y;$(this.element).css("left")!==this.handleValue(a)&&$(this.element).css("left",this.handleValue(a)),$(this.element).css("top")!==this.handleValue(b)&&$(this.element).css("top",this.handleValue(b))};