"use strict";var adr=__imns("util.classes");"ClipBox"in adr||(adr.ClipBox=function(a){var b=__imns("util.classes"),c=__imns("util.debug");this.element=null,this.parentElement=null,this.container=null,this.angle=90,this.constrainParent=!0,this._determineInnerWidth=null,this._determineInnerHeight=null,this._determineOuterWidth=null,this._determineOuterHeight=null,this.outer={width:0,height:0},this.inner={width:0,height:0},this.working=new b.CoordinatesBox;var d=this.init(a);return d?(this.element.style.visibility="visiblie",this):((new c.IMDebugger).pass("Unable to initialise ClipBox"),!1)},adr.ClipBox.prototype.init=function(a){var b=__imns("util.validation"),c=__imns("util.dom"),d=__imns("util.tools");if(b.isHTMLElement(a))this.element=this.checkElement(a);else if("object"==typeof a){if("direction"in a)switch(a.direction){case"ttb":this.angle=0;break;case"bbt":this.angle=180;break;case"rtl":this.angle=270;break;case"ltr":case"default":this.angle=90}else"angle"in a&&!isNaN(parseFloat(a.angle))&&isFinite(a.angle)&&(this.angle=d.simplifyDegrees(a.angle));this.constrainParent="constrainParent"in a&&a.constrainParent?!0:!1,this.element="element"in a&&b.isHTMLElement(a.element)?this.checkElement(a.element):null,this.container="container"in a&&b.isHTMLElement(a.container)?a.container:null,this._determineInnerWidth="determineInnerWidth"in a&&"function"==typeof a.determineInnerWidth?a.determineInnerWidth:null,this._determineInnerHeight="determineInnerHeight"in a&&"function"==typeof a.determineInnerHeight?a.determineInnerHeight:null,this._determineOuterWidth="determineOuterWidth"in a&&"function"==typeof a.determineOuterWidth?a.determineOuterWidth:null,this._determineOuterHeight="determineOuterHeight"in a&&"function"==typeof a.determineOuterHeight?a.determineOuterHeight:null}else if("string"==typeof a){var e=c.findElementsBySelector(a);e.length>0&&b.isHTMLElement(e[0])&&(this.element=this.checkElement(e[0]))}return null!==this.element?(this.parentElement=c.findParent(this.element),this.container=null===this.container?this.parentElement:this.container,this.determineInnerWidth(),this.determineInnerHeight(),this.determineOuterWidth(),this.determineOuterHeight(),!0):!1},adr.ClipBox.prototype.initialised=function(){return 0===this.outer.width||0===this.outer.height||0===this.inner.width||0===this.inner.height?!1:!0},adr.ClipBox.prototype.move=function(a){var b=__imns("util.tools"),c=__imns("util.dom");a=b.convertToPixelNumber(a);var d={left:b.convertToPixelNumber(c.findElementStyle(this.element,"left")),top:b.convertToPixelNumber(c.findElementStyle(this.element,"top"))},e=b.calculateAngledDistance(this.angle,a);d.left+=e.x,d.top+=e.y,this.reposition(d)},adr.ClipBox.prototype.determine=function(){if(this.initialised()){var a=__imns("util.tools"),b=__imns("util.dom"),c=__imns("util.classes");this.working=new c.CoordinatesBox;var d={top:a.convertToPixelNumber(b.findElementStyle(this.element,"top")),right:a.convertToPixelNumber(b.findElementStyle(this.element,"right")),bottom:a.convertToPixelNumber(b.findElementStyle(this.element,"bottom")),left:a.convertToPixelNumber(b.findElementStyle(this.element,"left"))},e={top:d.top,left:d.left};this.reposition(e)}},adr.ClipBox.prototype.reposition=function(a){if(this.initialised()){var b=__imns("util.tools"),c=__imns("util.validation"),d=__imns("util.classes");this.working=new d.CoordinatesBox,this.working.x2=this.outer.width,this.working.y2=this.outer.height;var e={top:0,left:0};if(c.isArray(a)){var f={};if(4===a.length)f={top:b.convertToPixelNumber(a[0]),right:b.convertToPixelNumber(a[1]),bottom:b.convertToPixelNumber(a[2]),left:b.convertToPixelNumber(a[3])};else if(a.length%2===0&&a.length<9)for(var g=0;g<a.length;){var h=a[g],i=b.convertToPixelNumber(a[g+1]);f[h]=i,g+=1}a=f}return"object"==typeof a&&("right"in a&&(e.left-=b.convertToPixelNumber(a.right)),"left"in a&&(e.left+=b.convertToPixelNumber(a.left)),"bottom"in a&&(e.top-=b.convertToPixelNumber(a.bottom)),"top"in a&&(e.top+=b.convertToPixelNumber(a.top))),this.setVertical(e.top),this.setHorizontal(e.left),this.setClip(),this.setXY(),!0}var j=__imns("util.debug");return(new j.IMDebugger).pass("ClipBox is not properly initialised. Aborting"),!1},adr.ClipBox.prototype.setHorizontal=function(a){this.working.x1=a,this.inner.width<this.outer.width?(this.working.x1=0,this.working.x2=this.inner.width):(this.working.x2=this.working.x1+this.inner.width,this.working.x2<this.outer.width?(this.working.x2=this.outer.width,this.working.x1=this.working.x2-this.inner.width):this.working.x1>0&&(this.working.x1=0,this.working.x2=this.working.x1+this.inner.width)),this.working.x1<0&&(this.working.x=this.working.x1,this.working.x1=Math.abs(this.working.x1),this.working.x2+=this.working.x1)},adr.ClipBox.prototype.setVertical=function(a){this.working.y1=a,this.inner.height<this.outer.height?(this.working.y1=0,this.working.y2=this.inner.height):(this.working.y2=this.working.y1+this.inner.height,this.working.y2<this.outer.height?(this.working.y2=this.outer.height,this.working.y1=this.working.y2-this.inner.height):this.working.y1>0&&(this.working.y1=0,this.working.y2=this.working.y1+this.inner.height)),this.working.y1<0&&(this.working.y=this.working.y1,this.working.y1=Math.abs(this.working.y1),this.working.y2+=this.working.y1)},adr.ClipBox.prototype.checkElement=function(a){var b=__imns("util.dom"),c=b.findParent(a),d=b.findElementStyle(c,"position"),e=b.findElementStyle(a,"position"),f="relative"===d||"absolute"===d?!0:!1,g="absolute"===e||"relative"===e?!0:!1,h="hidden"===b.findElementStyle(a,"visibility")?!0:!1;return f&&g&&h?a:null},adr.ClipBox.prototype.parseClip=function(){var a=__imns("util.tools"),b=__imns("util.dom"),c=b.findElementStyle(this.element,"clip"),d={top:0,right:0,bottom:0,left:0};if(0===c.indexOf("rect(")){c=c.substring(5),c=c.substring(0,c.length-1);var e=[];-1!==c.indexOf(", ")?e=c.split(", "):-1!==c.indexOf(",")?e=c.split(","):-1!==c.indexOf(" ")&&(e=c.split(" ")),4===e.length&&(d.top=a.convertToPixelNumber(e[0]),d.right=a.convertToPixelNumber(e[1]),d.bottom=a.convertToPixelNumber(e[2]),d.left=a.convertToPixelNumber(e[3]))}return d},adr.ClipBox.prototype.determineOuterWidth=function(){var a=__imns("util.dom"),b=__imns("util.tools"),c="function"==typeof this._determineOuterWidth?this._determineOuterWidth():a.findElementStyle(this.container,"innerWidth");this.outer.width=b.convertToPixelNumber(c)},adr.ClipBox.prototype.determineOuterHeight=function(){var a=__imns("util.dom"),b=__imns("util.tools"),c="function"==typeof this._determineOuterHeight?this._determineOuterHeight():a.findElementStyle(this.container,"innerHeight");this.outer.height=b.convertToPixelNumber(c)},adr.ClipBox.prototype.determineInnerWidth=function(){var a=__imns("util.dom"),b=__imns("util.tools"),c="function"==typeof this._determineInnerWidth?this._determineInnerWidth():a.findElementStyle(this.element,"outerWidth");this.inner.width=b.convertToPixelNumber(c)},adr.ClipBox.prototype.determineInnerHeight=function(){var a=__imns("util.dom"),b=__imns("util.tools"),c="function"==typeof this._determineInnerHeight?this._determineInnerHeight():a.findElementStyle(this.element,"outerHeight");this.inner.height=b.convertToPixelNumber(c)},adr.ClipBox.prototype.handleValue=function(a){return 0===a?"auto":a+"px"},adr.ClipBox.prototype.setClip=function(){var a="rect("+this.handleValue(this.working.y1)+" "+this.handleValue(this.working.x2)+" "+this.handleValue(this.working.y2)+" "+this.handleValue(this.working.x1)+")";this.element.style.clip=a,this.constrainParent&&(this.parentElement.style.width=this.working.x2-this.working.x1+"px",this.parentElement.style.height=this.working.y2-this.working.y1+"px")},adr.ClipBox.prototype.setXY=function(){var a=__imns("util.dom"),b=this.handleValue(this.working.x),c=this.handleValue(this.working.y);a.findElementStyle(this.element,"left")!==b&&(this.element.style.left=b),a.findElementStyle(this.element,"top")!==c&&(this.element.style.top=c)},adr.CoordinatesBox=function(){this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.requiresAlteration=!1,this.x=0,this.y=0});