"use strict";var adr=__imns("component.classes");"PerfectGrid"in adr||(adr.PerfectGrid=function(){var a=__imns("component.classes"),b=!1,c=!1,d={};return void 0!==a.PerfectGrid.prototype.singleton?(arguments&&arguments.length&&a.PerfectGrid.prototype.singleton.build(arguments),a.PerfectGrid.prototype.singleton):(a.PerfectGrid.prototype.singleton=this,b=!0,this.rows=[],this.args=[],this.fix_on_resize_boo=!0,this.refresh_boo=!0,this.minimum_margin=0,this.last_method_str="strict",this.multiline_boo=!0,arguments.length>0&&(d=new a.PerfectGridArgs,c=d.init(arguments),b&&(this.minimum_margin="margin"in d.optional?d.optional.margin:this.minimum_margin,this.refresh_boo="refresh"in d.optional?d.optional.refresh:this.refresh_boo,this.fix_on_resize_boo="resize"in d.optional?d.optional.resize:this.fix_on_resize_boo,this.last_method_str="method"in d.optional?d.optional.method:this.last_method_str,this.multiline_boo="multiline"in d.optional?d.optional.multiline:this.multiline_boo),c&&this.build(arguments)),this.fix_on_resize_boo&&this.setResize(),this)},adr.PerfectGrid.prototype.findRowIdFromElement=function(a){var b=__imns("util.validation"),c=__imns("util.debug");if(void 0!==a&&b.isHTMLElement(a)){for(var d=!1,e=0,f=this.rows.length;f>e;e+=1)if(a===this.rows[e].element){d=e;break}return d}return(new c.IMDebugger).pass("PerfectRows.returnRowIdFromElement must be supplied a HTML Element"),!1},adr.PerfectGrid.prototype.findRowFromElement=function(a){var b=this.findRowIdFromElement(a);return b!==!1?this.rows[b]:void 0},adr.PerfectGrid.prototype.addRow=function(a){var b=__imns("component.classes"),c=__imns("util.debug");return a instanceof b.GridObject?this.elementExists(a.element)?this.rows[this.findRowIdFromElement(a.element)]:(this.rows.push(a),this.rows[this.rows.length-1].fix(),this.rows[this.rows.length-1]):void(new c.IMDebugger).pass("PerfectGrid.addRow must be supplied a valid GridObject.")},adr.PerfectGrid.prototype.deleteRowFromElement=function(a){var b=__imns("util.validation"),c=__imns("util.debug"),d=-1;return void 0!==a&&b.isHTMLElement(a)?this.elementExists(a)?(d=this.findRowIdFromElement(a),this.deleteRowFromId(d)):!1:((new c.IMDebugger).pass("PerfectGrid.deleteRowFromElement must be supplied a valid HTMLElement."),!1)},adr.PerfectGrid.prototype.deleteRowFromId=function(a){if(a>-1&&a<this.rows.length)return this.rows.splice(a,1),!0;var b=__imns("util.debug");return(new b.IMDebugger).pass("PerfectGrid.deleteRowFromId was supplied an invalid id that is outside the acceptable range."),!1},adr.PerfectGrid.prototype.deleteRedundantRows=function(){for(var a=__imns("util.validation"),b=__imns("util.dom"),c=this.rows.length-1,d=!1;c>-1;)void 0!==this.rows[c].element&&a.isHTMLElement(this.rows[c].element)&&b.inVisibleDOM(this.rows[c].element)||(d=this.deleteRowFromId(c)),c-=1;return this.rows.length},adr.PerfectGrid.prototype.elementExists=function(a){return this.findRowIdFromElement(a)===!1?!1:!0},adr.PerfectGrid.prototype.build=function(){var a=__imns("component.classes"),b=__imns("util.validation"),c=__imns("util.dom"),d=__imns("util.debug"),e=!1,f=!1,g={},h=[],i=[],j=null,k=0;if(arguments&&arguments.length>0)if(e=new a.PerfectGridArgs(arguments),e!==!1){g.multiline="multiline"in e.optional?e.optional.multiline:this.multiline_boo,g.margin="margin"in e.optional?e.optional.margin:this.minimum_margin,g.resize="resize"in e.optional?e.optional.resize:this.fix_on_resize_boo,g.method="method"in e.optional?e.optional.method:this.last_method_str,g.refresh="refresh"in e.optional?e.optional.refresh:this.refresh_boo,b.isHTMLElement(e.holder)?h.push(e.holder):"string"==typeof e.holder&&(h=c.findElementsBySelector(e.holder));for(var l=0,m=h.length;m>l;l+=1)g.id=this.rows.length,g.holder=h[l],g.box=e.box,j=new a.GridObject(g),j instanceof a.GridObject&&(this.elementExists(g.holder)?i.push(this.findRowFromElement(j.element)):(this.rows.push(j),k=this.rows.length-1,this.rows[k].fix(),i.push(this.rows[k])));if(g.refresh){g.holder=e.holder,g.box=e.box;for(var n=!1,o=0,p=this.args.length;p>o;o+=1)if(this.args[o].holder===g.holder){n=!0;break}n||this.args.push(g)}}else f=!0;else f=!0;return!f&&i.length>0?1===i.length?i[0]:i:((new d.IMDebugger).pass("PerfectGrid.build not supplied with valid objects"),!1)},adr.PerfectGrid.prototype.refresh=function(){this.deleteRedundantRows();for(var a=0,b=this.args.length;b>a;a+=1)this.build(this.args[a])},adr.PerfectGrid.prototype.resize=function(){var a=__imns("util.validation"),b=this,c=0;if(this.fix_on_resize_boo&&void 0!==this.rows&&this.rows.length>0){for(c=this.rows.length-1;c>-1;)void 0!==this.rows[c].element&&a.isHTMLElement(this.rows[c].element)?this.rows[c].resize===!0&&b.rows[c].fix():this.deleteRowFromId(c),c-=1;return!0}return!1},adr.PerfectGrid.prototype.setResize=function(a){var b=void 0!==a&&a===!1?!1:!0,c=this,d=__imns("util.tools");b?(this.fix_on_resize_boo=!0,d.fetter(window,"resize",[c,function(){var a=__imns("util.tools");a.debounce(function(){c.resize()},500)}],!0,"both")):this.fix_on_resize_boo=!1},adr.GridObject=function(){this.to="",this.id=-1,this.resize=!1,this.element=void 0,this.boxIdentifier="*",this.type="justify",this.multiline=!0,this.customMarginRight=0,this.minimumMarginRight=0,this.hideOverflow=!1,this.numberOfItemsPerRow=1,this.totalItems=0,this.lastline=0,this.last_method="strict",this.callForMore=!1,this.callMoreAction=null,this.resizeHold="";for(var a=__imns("util.validation"),b=arguments;a.isArguments(b)&&1===b.length;)b=b[0];return this.init(b)?this:void 0},adr.GridObject.prototype.setElement=function(a){var b=__imns("util.validation"),c=__imns("util.dom");if("string"==typeof a){var d=c.findElementsBySelector(a);a=d.length>0?d[0]:null}return b.isHTMLElement(a)?(this.element=a,!0):!1},adr.GridObject.prototype.disableMultiline=function(){var a=__imns("util.validation"),b=this.childArray(),c=b.length>0&&a.isHTMLElement(b[0])?b[0]:void 0;if(!this.multiline){this.hideOverflow=!0;var d="100px";if(a.isHTMLElement(c)){var e=new(__imns("util.classes").BoundaryCoordinates)(c);d=e.height}this.element.style.height=d,this.element.style.overflow="hidden"}},adr.GridObject.prototype.init=function(a){var b=__imns("util.validation"),c=__imns("util.dom");if("holder"in a&&this.setElement(a.holder),void 0!==this.element){this.id="id"in a?parseInt(a.id):this.id,this.resize="resize"in a&&(a.resize===!0||a.resize===!1)?a.resize:this.resize,this.last_method="method"in a&&("strict"===a.method||"loose"===a.method)?a.method:this.last_method,this.multiline="multiline"in a&&(a.multiline===!0||a.multiline===!1)?a.multiline:this.multiline,this.multiline="row"in a?!1:this.multiline,this.multiline=c.hasClass(this.element,"perfectrow")||!this.multiline?!1:this.multiline;{c.findElementsBySelector(this.element,a.box).length}this.boxIdentifier="box"in a&&c.findElementsBySelector(this.element,a.box).length>0?a.box:"*";var d=this.childArray(),e=d.length>0&&b.isHTMLElement(d[0])?d[0]:void 0;return this.totalItems=d.length,this.multiline||this.disableMultiline(),this.minimumMarginRight=parseFloat("margin"in a?a.margin:c.findElementStyle(e,"margin-right")),!0}return!1},adr.GridObject.prototype.childArray=function(){for(var a=__imns("util.dom"),b=(__imns("util.validation"),a.findElementsBySelector(this.element,this.boxIdentifier)),c=0;c<b.length;c+=1)a.findParent(b[c])!==this.element?(b.splice(c,1),c-=1):"none"===a.findElementStyleDeep(b[c],"display")&&(b.splice(c,1),c-=1);return b},adr.GridObject.prototype.firstChild=function(){var a=this.childArray();return a.length>0?a[0]:null},adr.GridObject.prototype.fix=function(){for(var a=this.childArray(),b=0,c=a.length;c>b;b+=1)a[b].style["margin-right"]=0,this.resolveItem(a[b],b)},adr.GridObject.prototype.getSpaceSize=function(){var a=.3,b=__imns("util.dom"),c=__imns("util.tools"),d=b.findElementStyle(this.element,"font-size");return parseFloat(c.measure(d,"px",this.element))*a},adr.GridObject.prototype.determineType=function(){var a=this.firstChild(),b=__imns("util.validation"),c=__imns("util.dom");if(b.isHTMLElement(a)){var d=c.findElementStyle(a,"display");"inline-block"===d&&this.multiline?this.type="justify":"block"!==d&&this.multiline||(this.type="float")}return this.type},adr.GridObject.prototype.getItemHeight=function(){var a=__imns("util.validation"),b=__imns("util.dom"),c=__imns("util.debug"),d=0,e=this.childArray(),f=e.length,g=0;if(f>0&&void 0!==this.element&&a.isHTMLElement(this.element)){for(;f>0;)f-=1,g=parseFloat(b.findElementStyle(e[f],"outerHeight")),g=Math.ceil(g),d=g>d?g:d;return d}return(new c.IMDebugger).pass("Grid Element does not exist!"),0},adr.GridObject.prototype.getItemWidth=function(){var a=__imns("util.validation"),b=__imns("util.dom"),c=__imns("util.debug"),d=this.childArray(),e=0,f=d.length;if(void 0!==this.element&&a.isHTMLElement(this.element)){for(var g=0;f>g;g+=1)e+=parseFloat(b.findElementStyle(d[g],"offsetWidth"));return e>0?Math.ceil(e/f):0}return(new c.IMDebugger).pass("Row Element does does not exist!"),0},adr.GridObject.prototype.calculateCustomMargin=function(){var a=__imns("util.dom"),b=__imns("util.classes"),c=this.childArray(),d=c[0]?c[0]:null,e=c[1]?c[1]:null,f=null!==d?parseFloat(new b.BoundaryCoordinates(d).left):0,g=null!==e?parseFloat(new b.BoundaryCoordinates(e).left):0;return f+=parseFloat(a.findElementStyle(d,"offsetWidth")),g-=f,g-=this.getSpaceSize(),g=Math.ceil(g),0>g?0:g},adr.GridObject.prototype.resolveItem=function(a,b){var c=this;switch(b){case 0:this.initialize();case 1:this.resolveFromSecondItem(a);default:this.defaultItemResolution(a),(b+1)%this.numberOfItemsPerRow===0&&this.lastOfRowResolution(a),b%this.numberOfItemsPerRow===0&&this.firstOfRowResolution(a),(b>=this.lastline&&b!==this.totalItems-1||!this.multiline)&&this.finalRowItemFix(a),b>=this.lastline&&b===this.totalItems-1&&(c.to=setTimeout(function(){c.resize=c.resizeHold,c.resizeHold="",clearTimeout(c.to)},1e3)),b>=this.numberOfItemsPerRow&&this.overflowResolution(a)}},adr.GridObject.prototype.initialize=function(){var a,b,c,d=__imns("util.dom"),e=__imns("util.validation"),f=0,g=this.childArray(),h=0,i=null;this.resizeHold=this.resize,this.resize=!1,i=d.findElementsBySelector(this.element,"br.ie7breakpoints"),e.isHTMLElement(i)&&"removeChild"in this.element&&this.element.removeChild(i);for(a=0,b=g.length;b>a;a+=1)g[a].style["margin-right"]="0";switch(h=d.findElementStyle(this.element,"offsetWidth"),this.multiline||(f=parseFloat(this.getItemHeight()),c=parseFloat(d.findElementStyle(this.element,"offsetHeight"))-parseFloat(d.findElementStyle(this.element,"innerHeight")),this.element.style.height=c+f+"px",this.element.style["min-height"]=c+f+"px"),this.determineType()){case"justify":this.initializeJustify();break;case"float":this.initializeFloat()}},adr.GridObject.prototype.initializeJustify=function(){var a=__imns("util.dom"),b=a.findElementStyle(this.element,"offsetWidth"),c=0,d=0,e=0,f=this.childArray(),g=this.getSpaceSize(),h=b+g;if(this.numberOfItemsPerRow=Math.floor(h/(this.getItemWidth()+g)),this.customMarginRight=b-this.getItemWidth()*this.numberOfItemsPerRow,this.customMarginRight/=this.numberOfItemsPerRow,this.customMarginRight+g<this.minimumMarginRight){var i=0;c=0,i=this.minimumMarginRight-g;var j=i+"px";for(d=0,e=f.length;e>d;d+=1)f[d].style["margin-right"]=j;if(c=this.numberOfItemsPerRow,this.numberOfItemsPerRow=Math.floor(h/(this.getItemWidth()+i+g)),this.numberOfItemsPerRow!==c)for(this.customMarginRight=b-this.getItemWidth()*this.numberOfItemsPerRow,this.customMarginRight/=this.numberOfItemsPerRow,i=this.customMarginRight-g,j=i+"px",d=0,e=f.length;e>d;d+=1)f[d].style["margin-right"]=j;var k=a.findElementsBySelector(this.element,this.boxIdentifier+":nth-of-type("+this.numberOfItemsPerRow+"n)");for(d=0,e=k.length;e>d;d+=1)k[d].style["margin-right"]="0";this.customMarginRight=i}this.lastline=this.totalItems%this.numberOfItemsPerRow,this.lastline=0===this.lastline?this.numberOfItemsPerRow:this.lastline,this.lastline=this.totalItems-this.lastline},adr.GridObject.prototype.initializeFloat=function(){this.calculateCustomMarginRight()},adr.GridObject.prototype.calculateCustomMarginRight=function(){var a=__imns("util.dom"),b=parseFloat(a.findElementStyle(this.element,"innerWidth"));b-=1,this.numberOfItemsPerRow=Math.floor(b/(this.getItemWidth()+this.getSpaceSize())),this.customMarginRight=b-(this.getItemWidth()+this.getSpaceSize())*this.numberOfItemsPerRow,this.customMarginRight+=Math.floor(this.getSpaceSize())*this.numberOfItemsPerRow,this.customMarginRight=this.customMarginRight/(this.numberOfItemsPerRow-1),this.customMarginRightFix()},adr.GridObject.prototype.customMarginRightFix=function(){var a=__imns("util.dom"),b=0,c=parseFloat(a.findElementStyle(this.element,"innerWidth"));this.customMarginRight<this.minimumMarginRight&&(this.customMarginRight=this.minimumMarginRight,b=this.numberOfItemsPerRow,this.numberOfItemsPerRow=Math.floor((c+this.customMarginRight)/(this.getItemWidth()+this.customMarginRight+this.getSpaceSize())),b!==this.numberOfItemsPerRow&&(this.customMarginRight=c-this.getItemWidth()*this.numberOfItemsPerRow,this.customMarginRight=this.customMarginRight/(this.numberOfItemsPerRow-1),this.customMarginRight=this.customMarginRight))},adr.GridObject.prototype.resolveFromSecondItem=function(){"justify"===this.type&&"loose"===this.last_method&&(this.customMarginRight=this.calculateCustomMargin())},adr.GridObject.prototype.defaultItemResolution=function(a){var b=a.style;switch(b.visibility="visible",b.clear="none",this.type){case"justify":b["margin-left"]="0";break;case"float":b["margin-right"]=this.customMarginRight+"px"}},adr.GridObject.prototype.overflowResolution=function(a){var b=a.style;!this.multiline&&this.hideOverflow&&(b.visibility="hidden",b["margin-right"]="0")},adr.GridObject.prototype.createBrElement=function(){var a=__imns("util.dom"),b=null;return"createElement"in document&&(b=document.createElement("br"),a.setAttribute(b,"clear","all"),a.setAttribute(b,"class","ie7breakpoints"),a.setAttribute(b,"style","clear:both")),b},adr.GridObject.prototype.firstOfRowResolution=function(a){if(this.multiline)switch(this.type){case"float":a.style.clear="left",-1===navigator.appVersion.indexOf("MSIE 7.")||window.opera||(this.resize=!1,"insertBefore"in a&&this.element.insertBefore(a,this.createBrElement()))}},adr.GridObject.prototype.lastOfRowResolution=function(a){switch(this.type){case"float":a.style["margin-right"]="0"}},adr.GridObject.prototype.finalRowItemFix=function(a){var b=__imns("util.dom"),c=this.firstChild(),d=this.childArray(),e=0;if(this.multiline)switch(this.type){case"justify":switch(this.last_method){case"loose":a.style["margin-right"]=this.customMarginRight;break;case"strict":a.style["margin-right"]=this.calculateExactMargin(a)+"px"}}else{e=parseFloat(b.findElementStyle(c,"outerHeight"))-parseFloat(b.findElementStyle(c,"offsetHeight")),e=isNaN(e)?9:e,e+=parseInt(this.getItemHeight()),e+="px";for(var f=0,g=d.length;g>f;f+=1)d[f].style.height=e,d[f].style["min-height"]=e}},adr.GridObject.prototype.findBoxId=function(a){var b=__imns("util.validation"),c=__imns("util.debug"),d=!1,e=this.childArray();if(void 0!==a&&b.isHTMLElement(a)){for(var f=0,g=e.length;g>f;f+=1)if(e[f]===a){d=f;break}return d}return(new c.IMDebugger).pass("GridObject.findBoxId must be supplied a HTML Element"),!1},adr.GridObject.prototype.calculateExactMargin=function(a){var b=__imns("util.classes"),c=__imns("util.dom"),d=this.findBoxId(a),e=d%this.numberOfItemsPerRow,f=0,g=0,h=this.childArray();return e===d?this.minimumMarginRight:(g=parseFloat(new b.BoundaryCoordinates(h[e+1]).left),f=parseFloat(new b.BoundaryCoordinates(h[d]).left)+parseFloat(c.findElementStyle(h[d],"outerWidth")),g-=f,g-=this.getSpaceSize(),g)},adr.PerfectGridArgs=function(){var a=!1;return this.holder=null,this.box=null,this.optional={},arguments.length>0?(a=this.init(arguments),a===!1?!1:this):this},adr.PerfectGridArgs.prototype.init=function(a){for(var b,c=__imns("util.validation");c.isArguments(a)&&1===a.length;)a=a[0];return 2===a.length?(this.holder=a[0],this.box=a[1]):"object"==typeof a&&(this.holder="holder"in a?a.holder:null,this.box="box"in a?a.box:null,"margin"in a&&(b="string"==typeof a.margin?parseFloat(a.margin):Number(a.margin),isNaN(b)||(this.optional.margin=a.margin)),"multiline"in a&&(this.optional.multiline=a.multiline===!1?!1:!0),"resize"in a&&(this.optional.resize=a.resize===!1?!1:!0),"refresh"in a&&(this.optional.refresh=a.refresh===!1?!1:!0),"method"in a&&(this.optional.method="strict"===a.method||"loose"===a.method?a.method:"strict")),null!==this.box&&null!==this.holder?!0:!1});