"use strict";var adr=__imns("component.classes");"Srcsetter"in adr||(adr.SrcSetter=function(){var a=__imns("component.classes"),b=__imns("util.tools");if(void 0!==a.SrcSetter.prototype.singleton)return a.SrcSetter.prototype.singleton;a.SrcSetter.prototype.singleton=this,this.supportsSrcset=-1,this.dppx=-1,this.processed=[];var c=this;b.fetter(window,"load",[c,function(){c.processAll()}],!0,"both")},adr.SrcSetter.prototype.returnPixelRatio=function(){if(-1!==this.dppx)return this.dppx;if("devicePixelRatio"in window)return this.dppx=Math.floor(window.devicePixelRatio),this.dppx;if("matchMedia"in window){var a="";if(a="(-webkit-min-device-pixel-ratio: 3), (min--moz-device-pixel-ratio:3), (min-device-pixel-ratio:3), (min-resolution: 3dppx), (min-resolution:288dpi)",window.matchMedia(a).matches)return this.dppx=3,this.dppx;if(a="(-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio:2), (min-device-pixel-ratio:2), (min-resolution: 2dppx), (min-resolution:192dpi)",window.matchMedia(a).matches)return this.dppx=2,this.dppx}return this.dppx=1,1},adr.SrcSetter.prototype.isSrcsetSupported=function(){if(-1!==this.supportsSrcset)return this.supportsSrcset;var a=new Image;return"hasOwnProperty"in a?(this.supportsSrcset=a.hasOwnProperty("srcset")?!0:!1,this.supportsSrcset):(this.supportsSrcset="srcset"in a?!0:!1,this.supportsSrcset)},adr.SrcSetter.prototype.beenProcessed=function(a){for(var b=0,c=this.processed.length;c>b;b+=1)if(a===this.processed[b])return!0;return!1},adr.SrcSetter.prototype.processAll=function(){var a=__imns("util.dom");if(this.isSrcsetSupported())return!1;for(var b=a.findElementsByTag("img"),c=0,d=b.length;d>c;c+=1)this.processImage(b[c]);return!0},adr.SrcSetter.prototype.processImage=function(a){if(!this.isSrcsetSupported()&&(a.hasAttribute("srcset")||"srcset"in a)&&!this.beenProcessed(a)){var b=this.getSrcFromSrcSet(a);if(this.processed.push(a),""!==b)return"currentSrc"in a&&a.currentSrc!==b?(a.currentSrc=b,!0):"src"in a&&a.src!==b?(a.src=b,!0):!0}},adr.SrcSetter.prototype.getSrcFromSrcSet=function(a){var b,c,d,e=this.getImageSrcSet(a),f=this.returnPixelRatio();for(b=f,d=0;b>d;b-=1)if(void 0!==e[b])return e[b];for(b=f,c=e.length;c>b;b+=1)if(void 0!==e[b])return e[b];return""},adr.SrcSetter.prototype.getImageSrcSet=function(a){for(var b,c=__imns("util.tools"),d=[],e=c.getAttribute(a,"src"),f=c.getAttribute(a,"srcset"),g="string"==typeof f?f.split(","):[],h=/\s*([A-Za-z0-9\:\.\/\-\_]+)\s*([0-9])x\s*/,i=0,j=g.length;j>i;i+=1)"string"==typeof g[i]&&h.test(g[i])&&(b=g[i].match(h),void 0!==b[1]&&void 0!==b[2]&&(d[Number(b[2])]=b[1]));return void 0===d[1]&&"string"==typeof e&&(d[1]=e),d});