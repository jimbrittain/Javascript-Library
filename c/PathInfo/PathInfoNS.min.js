"use strict";!function(){var a=__imns("util.classes"),b=__imns("util.tools");"PathInfo"in a||(a.PathInfo=function(a){this.url="",this.protocol="",this.domain="",this.phpleading=!1,this.folderString="",this.folderList=[],this.file="",this.filename="",this.extension="",this.getVarsString="",this.getVarsList=[],this.hash="",this._reg=/^(?:(?:(http\:\/\/|https\:\/\/)((?:(?:[0-9]{1,3}\.){3,5}[0-9]{1,3})|(?:(?:[A-Za-z0-9\_\-]{1,63}\.)+(?:[A-Za-z0-9\-\_]{1,63}))))(?:\/)?|(file\:\/\/\/)|(\/)){0,1}((?:(?:[a-zA-Z0-9\-\_\%\.  ]+)(?:\/))+)??([a-zA-Z0-9\-\_\%\&\.\=]+)?(?:\?([a-zA-Z0-9\-\_\%\&\.\=]+))?(?:\#([a-zA-Z0-9\-\_]+))?$/,this.set(a)},a.PathInfo.prototype.clear=function(){return this.url="",this.protocol="",this.domain="",this.phpleading=!1,this.folderString="",this.folderList=[],this.file="",this.filename="",this.extension="",this.getVarsString="",this.getVarsList=[],this.hash="",!0},a.PathInfo.prototype.set=function(a){this.clear(),void 0!==a?this.setUrl(a):this.setUrl(window.location.href)},a.PathInfo.prototype.parse=function(a){this.url=a,this.domain=this.parseDomain(),this.parseFolders(),this.parseGetVars(),this.hash=this.parseHash()},a.PathInfo.prototype.parseFolders=function(){this.folderString=this.parseFolderString(),this.foldersList=this.parseFolderList()},a.PathInfo.prototype.parseGetVars=function(){this.getVars=this.parseGetVarsString(),this.getVarsList=this.parseGetVarsList()},a.PathInfo.prototype.setHash=function(a){this.hash=a,this.produceUrl()},a.PathInfo.prototype.addHash=a.PathInfo.prototype.setHash,a.PathInfo.prototype.produceGetVarsString=function(){for(var a=__imns("util.validation"),b="",c=0,d=this.getVarsList.length;c<d;c+=1){var e="",f=this.getVarsList[c].name,g=this.getVarsList[c].value;if(a.isArray(g))for(var h=0,i=g.length;h<i;h+=1)e+=e.length>0?"&":"",e+=f+"[]="+g[h];else e=f+"="+g;b+=b.length>0?"&"+e:e}return this.getVarsString=b,b},a.PathInfo.prototype.produceFolderString=function(){for(var a="",b=0,c=this.folderList.length;b<c;b+=1)a+=this.folderList[b]+"/";return a},a.PathInfo.prototype.produceUrl=function(){var a="";return a+=this.protocol,a+=this.domain,a+="/",a+=this.produceFolderString(),a+=this.file,a+=this.getVarsString.length>0?"?"+this.getVarsString:"",a+=this.hash.length>0?"#"+this.hash:"",this.url=a,a},a.PathInfo.prototype.findGetVar=function(a){var b=__imns("util.validation"),c=this.getVarsList;if(b.isString(a)&&a.length>0)for(var d=0,e=c.length;d<e;d+=1)if(c[d].name===a)return c[d].value},a.PathInfo.prototype.addGetVars=function(a,b){var c=__imns("util.validation");b=!!b,a=c.isArray(a)?a:[a];for(var d=0,e=a.length;d<e;d+=1)this.addGetVar(a[d],b)},a.PathInfo.prototype.removeGetVars=function(a){var b=__imns("util.validation");a=b.isArray(a)?a:[a];for(var c=0,d=a.length;c<d;c+=1)this.removeGetVar(a[c])},a.PathInfo.prototype.removeGetVar=function(a){var b=__imns("util.validation"),c="",d="";b.isString(a)?c=a:"object"==typeof a&&a.name&&(c=a.name,"value"in a&&(d=a.value));for(var e=0;e<this.getVarsList.length;e+=1){var f=this.getVarsList[e].name,g=this.getVarsList[e].value;if(f===c){if(0===d.length){this.getVarsList.splice(e,1),e-=1;continue}if(b.isArray(g)){for(var h=0;h<g.length;h+=1)g[h]===d&&(g.splice(h,1),this.getVarsList[e].value.splice(h,1),h-=1);0===this.getVarsList[e].value.length&&(this.getVarsList.splice(e,1),e-=1)}else g===d&&(this.getVarsList.splice(e,1),e-=1)}}this.produceGetVarsString(),this.produceUrl(),this.parseUrl()},a.PathInfo.prototype.findGetVar=function(a){for(var b=0,c=this.getVarsList.length;b<c;b+=1){var d=this.getVarsList[b];if(d.name===a)return d}return!1},a.PathInfo.prototype.addGetVar=function(a,b){var c,d,e=__imns("util.validation");"object"==typeof a&&"name"in a&&"value"in a&&(c=a.name,d=a.value);var f=this.findGetVar(c);f!==!1?(b=!!b,b?(e.isArray(f.value)||(f.value=[f.value]),f.value.push(d)):f.value=d):this.getVarsList.push({name:c,value:d}),this.produceGetVarsString(),this.produceUrl(),this.parseUrl()},a.PathInfo.prototype.shouldUseSelf=function(a){var b=__imns("util.classes");return a=void 0!==a&&this.isValid(a)?a:this.url,a!==this.url?new b.PathInfo(a):this},a.PathInfo.prototype.get=function(a,c){var d=__imns("util.classes"),e=__imns("util.validation"),f=this.shouldUseSelf(a);if("getVarsList"===c&&b.objectkeys(f[c]).length>0)return f[c];if(!(null===f[c]||e.isArray(f[c])&&f[c].length<1)){if(("folders"===c||"folderString"===c||"folderlist"===c||"folderList"===c)&&this.isRelative(a)){var g=new d.PathInfo(a).mergeFolderLists(new d.PathInfo(window.location.href).folderList,f.folderList);return"folders"===c||"folderString"===c?g.join("/")+(g.length>0?"/":""):g}return f[c]}return this.isSelfByNeglect(a)?new d.PathInfo(window.location.href)[c]:null},a.PathInfo.prototype.getHash=function(a){return this.get(a,"hash")},a.PathInfo.prototype.getGetVarsString=function(a){return this.get(a,"getVarsString")},a.PathInfo.prototype.getGetVarsList=function(a){return this.get(a,"getVarsList")},a.PathInfo.prototype.getScheme=function(a){return this.get(a,"scheme")},a.PathInfo.prototype.getHost=function(a){return this.get(a,"host")},a.PathInfo.prototype.getProtocol=function(a){return this.get(a,"protocol")},a.PathInfo.prototype.getDomain=function(a){return this.get(a,"domain")},a.PathInfo.prototype.getFile=function(a){return this.get(a,"file")},a.PathInfo.prototype.getFilename=function(a){return this.get(a,"filename")},a.PathInfo.prototype.getFileExtension=function(a){return this.get(a,"extension")},a.PathInfo.prototype.getPort=function(a){return this.get(a,"port")},a.PathInfo.prototype.getUser=function(a){return this.get(a,"user")},a.PathInfo.prototype.getFolders=function(a){return this.get(a,"folderString")},a.PathInfo.prototype.getFolderList=function(a){return this.get(a,"folderlist")},a.PathInfo.prototype.isSelf=function(a){a=void 0!==a&&this.isValid(a)?a:this.url;var b={protocol:this.getProtocol(a),domain:this.getDomain(a),folderString:this.getFolders(a),file:this.getFile(a)},c=this.parseUrl(window.location.href);return b.protocol===c.protocol&&b.domain===c.domain&&b.folderString===c.folderString&&b.file===c.file},a.PathInfo.prototype.isSelfByNeglect=function(a){var b=this.shouldUseSelf(a).parseUrl();return""===b.file&&""===b.protocol&&""===b.domain&&""===b.folderString},a.PathInfo.prototype.mergeFolderLists=function(a,b){var c=__imns("util.validation"),d=__imns("util.classes"),e=!1;if(1===arguments.length&&(b=a,a=this.folderList,e=!0),c.isArray(a)||(c.isString(a)?a=new d.PathInfo(a).folderList:"object"==typeof a&&a.constructor===d.PathInfo&&(a=a.folderList)),c.isArray(b)||(c.isString(b)?b=new d.PathInfo(b).folderList:"object"==typeof b&&b.constructor===d.PathInfo&&(b=b.folderList)),c.isArray(a)&&c.isArray(b))for(var f=0,g=b.length;f<g;f+=1)".."===b[f]?a.pop():a.push(b[f]);return e&&(this.folderList=a,this.produceUrl()),a},a.PathInfo.prototype.isPHPLeading=function(a){return this.phpleading===!0},a.PathInfo.prototype.isHTTPS=function(a){return"https://"===this.getProtocol(a)},a.PathInfo.prototype.isRelative=function(a){a=void 0!==a&&this.isValid(a)?a:this.url;var b=this.parseUrl(a);return""===b.domain},a.PathInfo.prototype.isAbsolute=function(a){return!this.isRelative(a)},a.PathInfo.prototype.isLocal=function(a){a=void 0!==a&&this.isValid(a)?a:this.url;var b=this.parseUrl(a),c=this.getDomain("index.htm");return b.domain===c},a.PathInfo.prototype.isValid=function(a){var b=__imns("util.validation");return a=void 0!==a&&b.isString(a)?a:this.url,!!(a.length>0&&this._reg.test(a))},a.PathInfo.prototype.setUrl=function(a){return void 0!==a&&this.isValid(a)?(this.url=a,this.parseUrl(),!0):""===a&&(this.url=window.location.href,void this.parseUrl())},a.PathInfo.prototype.parseUrl=function(a){a=void 0!==a&&this.isValid(a)?a:this.url;var b=this._reg.exec(a);return a.length>0&&b&&(void 0!==b[1]?this.protocol=b[1]:void 0!==b[3]&&(this.protocol=b[3]),void 0!==b[2]&&(this.domain=b[2],this.cc=this.parseCCFragment(this.domain)),void 0!==b[4]&&(this.phpleading="/"===b[4]),void 0!==b[5]&&(this.folderString=b[5],this.folderList=this.parseFolderListFragment(this.folderString)),void 0!==b[6]&&(this.file=b[6],this.filename=this.parseFileNameFragment(this.file),this.extension=this.parseFileExtensionFragment(this.file)),void 0!==b[7]&&(this.getVarsString=b[7],this.getVarsList=this.parseGetVarsListFragment(this.getVarsString)),void 0!==b[8]&&(this.hash=b[8])),this},a.PathInfo.prototype.parseFileNameFragment=function(a){if("string"==typeof a){var b=/^([a-zA-Z0-9\_\-\.]+?)(?:\.(?:[a-zA-Z0-9\_\-]{1,5}))?$/;if(b.test(a))return b.exec(a)[1]}},a.PathInfo.prototype.parseFileExtensionFragment=function(a){if("string"==typeof a){var b=/\.([a-zA-Z0-9\_\-]{1,5})$/;if(b.test(a))return b.exec(a)[1]}},a.PathInfo.prototype.parseCCFragment=function(a){},a.PathInfo.prototype.parseGetVarsListFragment=function(a){if("string"==typeof a){a=a.replace("&amp;","&");for(var b=__imns("util.validation"),c=a.split(/\&/),d=/^([a-zA-Z0-9\-\_]+)(?:\[\])?(?:=([a-zA-Z0-9\,\.\-\+\%]+))?$/,e=[],f=0,g=c.length;f<g;f+=1)if(d.test(c[f])){var h=d.exec(c[f]),i=h[1],j=h[2];i in e?(b.isArray(e[i])||(e[i]=[e[i]]),e[i].push(j)):e[i]=j}var k=[];for(var l in e)if(e.hasOwnProperty(l)){var m={name:l,value:e[l]};k.push(m)}return k}return[]},a.PathInfo.prototype.parseFolderListFragment=function(a){var b=(__imns("util.validation"),[]);if("string"==typeof a&&a.length>0)for(var c=a.split(/\//),d=0,e=c.length;d<e;d+=1)"string"==typeof c[d]&&c[d].length>0&&b.push(c[d]);return b}),b.isUrlLocal=function(a){var b=__imns("util.classes");if("PathInfo"in b)return!!new b.PathInfo(a).isLocal()},b.isUrlExternal=function(a){var b=__imns("util.classes");return!b.isUrlLocal(a)},b.parsePathInfo=function(a){var b=__imns("util.classes");if("PathInfo"in b){var c=new b.PathInfo;return c.setUrl(a)?c.parse():null}return null}}();