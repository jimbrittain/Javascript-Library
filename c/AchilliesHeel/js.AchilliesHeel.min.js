"use strict";function AchilliesHeel(a,b){return void 0!==AchilliesHeel.prototype.singleton?AchilliesHeel.prototype.singleton:(AchilliesHeel.prototype.singleton=this,this.element=null,this.lastY=0,this.fixedElement=null,this.initialized=!1,this.active=!1,this.method="absolute",this.offset=-100,this._overlap="waiting",this.scr=new ScreenProperties,void this.init(a,b))}AchilliesHeel.prototype.overlap=function(a){if(console.log("H@"+this.element),a=void 0===a?"a":a,!isNumber(a)){if("waiting"===this._overlap){if(isHTMLElement(this.element)){console.log("M");var b=findElementStyle(this.element,"bottom");return b=measure(b,"px",this.element),console.log("N"),b=parseFloat(b),this._overlap=b,this._overlap}return 0}return this._overlap}this._overlap=a},AchilliesHeel.prototype.setElement=function(a){return!(void 0===a||!isHTMLElement(a)||(this.element=a,this.reinitialize(),a!==this.element))},AchilliesHeel.prototype.setFixedElement=function(a){return!(void 0===a||!isHTMLElement(a)||(this.fixedElement=a,this.reinitialize(),a!==this.fixedElement))},AchilliesHeel.prototype.reinitialize=function(){this.initialized&&(this.initialized=!1,this.build())},AchilliesHeel.prototype.activate=function(){return!(this.active||!this.initialized)&&(this.active=!0,!0)},AchilliesHeel.prototype.suspend=function(){return this.active=!1,!0},AchilliesHeel.prototype.calculateHeightOffset=function(){var a=findElementStyle(this.element,"offsetTop"),b=this.scr.innerWindowHeight();return a=parseFloat(a)-parseFloat(b),console.log("calculateHeightOffset::"+a+":: should be a negative"),console.log(this.overlap()+":: hello"),isNumber(a)||(a=measure(parseFloat(findElementStyle(this.element,"height")),"px",this.element),a-=this.overlap()),AchilliesHeel.offset=a,this.offset},AchilliesHeel.prototype.isBaseLocked=function(){var a="absolute"!==this.element.style.position?parseFloat(this.scr.offsetY()):0,b=findElementStyle(this.element,"offsetTop"),c=findElementStyle(this.fixedElement,"offsetTop");if("static"!==findElementStyle(this.element,"position"))return b+a>=c;var d=parseFloat(this.scr.innerWindowHeight()),e=parseFloat(new BoundaryCoordinates(this.fixedElement).y1);if(a+d<e)return!1;var f=parseFloat(new BoundaryCoordinates(this.element).height),g=a+d-(f+this.offset);return!(g<e)},AchilliesHeel.prototype.fixedBaseLock=function(){if(this.active){var a=this.isBaseLocked()?"content":"fixed",b=this.element.style.position;switch(a){case"fixed":"static"===b&&(this.element.style.position="fixed"===this.method?"fixed":"absolute");break;case"content":"static"!==b&&(this.element.style.position="static")}}},AchilliesHeel.prototype.jsMethod=function(){if(this.active){this.fixedBaseLock();var a=this.scr.getPageBounds(),b=a.top+a.height-AchilliesHeel.prototype.heightOffset;this.element.style.top=b+"px"}},AchilliesHeel.prototype.runMethod=AchilliesHeel.prototype.fixedBaseLock,AchilliesHeel.prototype.init=function(a,b){this.setElement(a),this.setFixedElement(b),this.build()},AchilliesHeel.prototype.setBaseOffset=function(a){if(this.offset=-a,this.initialized);},AchilliesHeel.prototype.build=function(){var a=this,b=findElementStyle(this.element,"position");if(void 0===AchilliesHeel.prototype.heightOffset&&this.calculateHeightOffset(),"fixed"!==b)if("absolute"!==b){this.element.style.position="absolute";var c=parseFloat(new BoundaryCoordinates(this.element).height);this.element.style.height=c-this.offset+"px",AchilliesHeel.prototype.runMethod=AchilliesHeel.prototype.jsMethod,this.method="absolute",this.jsMethod()}else{var d="expression(((document.documentElement.scrollTop) ? document.documentElement.scrollTop : document.body.scrollTop) + this.offset)";this.element.style.bottom=d}else this.method="fixed";fetter(window,"scroll",function(){var b=a.scr.offsetY();b!==a.lastY&&a.runMethod(),a.lastY=b},!0),this.active=!0,this.initialized=!0};