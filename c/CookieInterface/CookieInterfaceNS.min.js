"use strict";var adr=__imns("util.classes");"CookieInterface"in adr||(adr.CookieInterface=function(){var a=__imns("util.classes");return void 0!==a.CookieInterface.prototype.singleton?a.CookieInterface.prototype.singleton:(a.CookieInterface.prototype.singleton=this,this.props=[],this.storage=this.hasStorage(),this.able=document.cookie||this.storage?!0:!1,void this.readExisting())},adr.CookieInterface.prototype.hasStorage=function(){try{if("sessionStorage"in window&&window.sessionStorage.length>-1&&"localStorage"in window&&window.localStorage.length>-1)return!0}catch(a){}return!1},adr.CookieInterface.prototype.getLength=function(){return this.props.length},adr.CookieInterface.prototype.keys=function(a){var b=__imns("util.classes"),c=[],d=null;if(void 0===a){c=[];for(var e=0,f=this.props.length;f>e;e+=1)c.push(this.props[e].name);return c}return"string"==typeof a&&(d=this.findItem(a),void 0!==d)?d:(a=Number(a),!isNaN(a)&&a>0&&Math.floor(a)===a?(d=this.props[a],d instanceof b.CookieObject?d:void 0):null)},adr.CookieInterface.prototype.readExisting=function(){var a=__imns("util.classes"),b=0,c=0,d=null,e=!1,f=null;if("sessionStorage"in window&&null!==window.sessionStorage&&window.sessionStorage.length>0)for(b=0,c=window.sessionStorage.length;c>b;b+=1)d=new a.CookieObject,f=window.sessionStorage.key(b),e=d.distillSession(f,window.sessionStorage.getItem(f)),e&&this.props.push(d);if("localStorage"in window&&null!==window.localStorage&&window.localStorage.length>0)for(b=0,c=window.localStorage.length;c>b;b+=1)d=new a.CookieObject,f=window.localStorage.key(b),e=d.distillLocal(f,window.localStorage.getItem(f)),e&&this.props.push(d);for(""!==document.cookie&&this.readCookies(),b=0,c=this.props.length;c>b;b+=1)(this.props[b].hasExpired()||this.props[b].isTooOld())&&(this.props[b].removeItem(),this.props.splice(b,1),c-=1,b-=1)},adr.CookieInterface.prototype.readCookies=function(){for(var a=__imns("util.classes"),b=document.cookie.split("; "),c=null,d=!1,e=0,f=b.length;f>e;e+=1)c=new a.CookieObject,d=c.distillCookie(b[e]),d&&this.props.push(c)},adr.CookieInterface.prototype.removeItem=function(a){var b=__imns("util.classes"),c=a instanceof b.CookieObject?a.name:a,d=!1;if("string"==typeof c)for(var e=0,f=this.props.length;f>e;e+=1)if(c===this.props[e]){d=this.props[e].remove(),this.props.splice(e,1);break}return!0},adr.CookieInterface.prototype.findItemId=function(a){var b=__imns("util.classes"),c=a instanceof b.CookieObject?a.name:a,d=-1;if("string"==typeof c)for(var e=0,f=this.props.length;f>e;e+=1)if(c===this.props[e].name){d=e;break}return d},adr.CookieInterface.prototype.hasItem=function(a){return-1===this.findItemId(a)?!1:!0},adr.CookieInterface.prototype.findItem=function(a){var b=this.findItemId(a);return-1!==b?this.props[b]:void 0},adr.CookieInterface.prototype.clear=function(a){var b=0,c=0;if(void 0!==a)if("session"===a)for(b=0,c=this.props.length;c>b;b+=1)null===this.props[b].expires&&(this.props[b].removeItem(),this.props.splice(b,1),c-=1,b-=1);else if("long"===a)for(b=0,c=this.props.length;c>b;b+=1)null!==this.props[b].expires&&(this.props[b].removeItem(),this.props.splice(b,1),c-=1,b-=1);else for(a="number"==typeof a?new Date(a):a,b=0,c=this.props.length;c>b;b+=1)this.props[b].expires===a&&(this.props[b].removeItem(),this.props.splice(b,1),c-=1,b-=1);else{for(b=0,c=this.props.length;c>b;b+=1)this.props[b].removeItem();this.props=[]}},adr.CookieInterface.prototype.addItem=function(a){var b=__imns("util.classes");if(a=a instanceof b.CookieObject?a:new b.CookieObject(a),this.hasItem(a))this.setItem(a);else if(""!==a.name&&""!==a.value)return this.props.push(a),this.props[this.props.length-1]},adr.CookieInterface.prototype.setItem=function(a){var b=__imns("util.classes");a=a instanceof b.CookieObject?a:new b.CookieObject(a);var c=null;return this.hasItem(a)?(c=this.findItem(a),c.beenSet&&(c.removeItem(),c.beenSet=!1),c.value!==a.value&&c.setValue(a.value),c.expires!==a.expires&&c.setExpires(a.expires),c.path!==a.path&&c.setPath(a.path),c.secure!==a.secure&&c.setSecure(a.secure),c.domain!==a.domain&&c.setDomain(a.domain),c.maxage!==a.maxage&&c.setMaxAge(a.maxage),c.created!==a.created&&c.setCreated(a.created)):c=this.addItem(a),c.setItem()},adr.CookieObject=function(a){var b=__imns("util.classes");this.name="",this.value="",this.value_type="",this.expires=null,this.path=this.defaultPath(),this.secure=!1,this.domain=this.defaultDomain(),this.maxage=null,this.created=(new Date).getTime(),this.master=new b.CookieInterface,this.beenSet=!1,void 0!==a&&this.init(a)},adr.CookieObject.prototype.init=function(a){if("object"==typeof a)"name"in a&&this.setName(a.name),"value"in a&&this.setValue(a.value),"expires"in a&&this.setExpires(a.expires),"path"in a&&this.setPath(a.path),"secure"in a&&this.setSecure(a.secure),"domain"in a&&this.setDomain(a.domain);else if(2===arguments.length&&(this.setName(arguments[0]),this.setValue(arguments[1]),""===this.name))return!1},adr.CookieObject.prototype.setName=function(a){"string"==typeof a&&(this.name=a)},adr.CookieObject.prototype.cookName=function(){return encodeURIComponent(this.name)},adr.CookieObject.prototype.cookValue=function(){var a=[this.value,null===this.expires?"session":this.expires.getTime(),this.created,this.path,this.secure,this.maxage,this.domain];return encodeURIComponent(a.join("**"))},adr.CookieObject.prototype.distillValue=function(a){if(a="string"==typeof a?decodeURIComponent(a):"",a.length>0){var b=a.split("**");return 7===b.length?(this.setValue(b[0]),this.setExpires(b[1]),this.setCreated(b[2]),this.setPath(b[3]),this.setSecure(b[4]),this.setMaxAge(b[5]),this.setDomain(b[6]),!0):(this.name="",!1)}},adr.CookieObject.prototype.hasExpired=function(){if(null===this.expires)return!1;var a=(new Date).getTime();return this.expires.getTime()<a?!0:!1},adr.CookieObject.prototype.isTooOld=function(){if(null===this.maxage)return!1;var a=(new Date).getTime();return this.created+1e3*this.maxage<a?!0:!1},adr.CookieObject.prototype.distillLocal=function(a,b){this.name=a;var c=this.distillValue(b);return this.beenSet=!0,c},adr.CookieObject.prototype.distillSession=function(a,b){this.name=a;var c=this.distillValue(b);return this.beenSet=!0,c},adr.CookieObject.prototype.distillCookie=function(a){var b=a.split("="),c=b[0],d=b[1];this.name=decodeURIComponent(c);var e=this.distillValue(d);return this.beenSet=!0,e},adr.CookieObject.prototype.defaultPath=function(){return"/"},adr.CookieObject.prototype.defaultDomain=function(){var a=window.location;return"host"in a?a.host:""},adr.CookieObject.prototype.makeSecure=function(){return this.setSecure(!0)},adr.CookieObject.prototype.setValue=function(a){this.value=a,this.beenSet&&this.setItem()},adr.CookieObject.prototype.setSecure=function(a){this.beenSet&&this.removeItem(),this.secure=a===!0||1===a||"true"===a?!0:!1,this.beenSet&&this.setItem()},adr.CookieObject.prototype.setCreated=function(a){this.beenSet&&this.removeItem(),a instanceof Date?this.created=a.getTime():"number"==typeof a&&Math.floor(a)===a&&a>-1&&(this.created=a),this.beenSet&&this.setItem()},adr.CookieObject.prototype.setExpires=function(a){this.beenSet&&this.removeItem(),this.expires=a instanceof Date?a:"number"==typeof a&&Math.floor(a)===a&&a>-1?new Date(a):null,this.beenSet&&this.setItem()},adr.CookieObject.prototype.setDomain=function(a){this.beenSet&&this.removeItem(),a="string"==typeof a?a:this.defaultDomain(),this.beenSet&&this.setItem()},adr.CookieObject.prototype.setPath=function(a){this.beenSet&&this.removeItem(),a="string"==typeof a?a:this.defaultPath(),this.beenSet&&this.setItem()},adr.CookieObject.prototype.setMaxAge=function(a){this.maxage="number"==typeof a&&a>-1&&Math.floor(a)===a?a:null},adr.CookieObject.prototype.cookExpires=function(){return null!==this.expires?"expires="+this.expires.toUTCString()+";":""},adr.CookieObject.prototype.cookMaxAge=function(){if(null!==this.maxage)return this.maxage;if(null===this.expires)return null;var a=new Date;return this.expires.getSeconds()-a.getSeconds()},adr.CookieObject.prototype.cookPath=function(){return"path="+this.path+";"},adr.CookieObject.prototype.cookDomain=function(){return"domain="+this.domain+";"},adr.CookieObject.prototype.cookSecure=function(){return this.secure?"secure;":""},adr.CookieObject.prototype.cook=function(){return this.master.able?this.cookName()+"="+this.cookValue()+";"+this.cookExpires()+this.cookPath()+this.cookMaxAge()+this.cookDomain()+this.cookSecure():""},adr.CookieObject.prototype.needsCookie=function(){return this.secure||this.defaultDomain()!==this.domain||this.defaultPath()!==this.path?!0:!1},adr.CookieObject.prototype.setItem=function(){if(!this.master.able)return!1;switch(this.determineMethod()){case 0:return document.cookie=this.cook(),this.beenSet=!0,!0;case 1:return this.determineStorage().setItem(this.cookName(),this.cookValue()),this.beenSet=!0,!0;default:return!1}},adr.CookieObject.prototype.determineMethod=function(){return this.master.able?this.master.storage&&!this.needsCookie()?1:0:-1},adr.CookieObject.prototype.determineStorage=function(){return null===this.expires?window.sessionStorage:window.localStorage},adr.CookieObject.prototype.removeItem=function(){if(!this.master.able)return!1;switch(this.determineMethod()){case 0:var a=new Date((new Date).setDate((new Date).getDate()-1));return document.cookie=this.cookName()+"=null;expires="+a.toUTCString(),!0;case 1:return this.determineStorage().removeItem(this.cookName()),!0;default:return!1}});