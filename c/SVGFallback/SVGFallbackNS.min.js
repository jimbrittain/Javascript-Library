"use strict";var adr=__imns("util.classes");"SVGFallback"in adr||(adr.SVGFallback=function(a){var b=__imns("util.classes");return b.SVGFallback.prototype.singleton?b.SVGFallback.prototype.singleton:(b.SVGFallback.prototype.singleton=this,this.js_libraryPath="../../../javascript-library/svgweb/",this.js_Path="../../../javascript-library/svgweb/svg.min.js",this.svg_testPath="../../../javascript-library/svgweb/spacer.svg",this.ready=!1,this.imageSupported=!1,this.imageTested=!1,this.imageTimeout=null,this.objectSupported=!1,this.objectTested=!1,this.elementsProcessed=[],this.testImage=null,this.testImageLocation=this.svg_testPath,this.svgScriptInterval=null,this.svgScriptId="__svgFallback_id_1",void(arguments&&1===arguments.length?this.init(a):this.init()))},adr.SVGFallback.prototype.insertBloatedSVGInclusion=function(){var a=__imns("util.dom"),b=__imns("util.debug"),c=document.getElementsByTagName("head")[0];if(c="getElementsByTagName"in document?document.getElementsByTagName("head")[0]:"all"in document?document.all.tags("HEAD")[0]:null,null!==c&&void 0===a.findElementByID(this.svgScriptId)){var d=this,e=document.createElement("SCRIPT");e.type="text/javascript",e.id=d.svgScriptId,e.onload=function(){d.loadedSVGInclusion()},e.onerror=function(){null!==d.svgScriptInterval&&clearInterval(this.svgScriptInterval)},e.onreadystatechange=function(){"complete"===this.readyState&&d.checkLoadingSVGInclusion()},e.src=d.js_Path,c.appendChild(e),this.svgScriptInterval=setInterval(function(){d.checkLoadingSVGInclusion()},50);try{"complete"===document.getElementById(this.svgScriptId).readyState&&d.checkLoadingSVGInclusion()}catch(f){}}else void 0!==a.findElementByID(this.svgScriptId)?this.checkLoadingSVGInclusion():(new b.IMDebugger).pass("SVGFallback: Document does not have or allow access to the DOM/Head tag.")},adr.SVGFallback.prototype.loadedSVGInclusion=function(){this.ready=!0,this.objectSupported=!0,this.processSVGImages(),null!==this.svgScriptInterval&&clearInterval(this.svgScriptInterval)},adr.SVGFallback.prototype.checkLoadingSVGInclusion=function(){var a=__imns("util.dom"),b=__imns("util.validation"),c=a.findElementByID(this.svgScriptId);void 0!==c&&b.isHTMLElement(c)&&"complete"===c.readyState&&this.loadedSVGInclusion()},adr.SVGFallback.prototype.isSVGObjectSupported=function(){return document.all&&parseFloat(navigator.appVersion.split("MSIE ")[1])<9&&!("opera"in window)?(this.processSVGObjectDowngrade(),!1):!0},adr.SVGFallback.prototype.processSVGObjectDowngrade=function(){var a=[];"getElementsByTagName"in document?a=document.getElementsByTagName("object"):document.all&&"tags"in document.all&&(a=document.all.tags("OBJECT"));for(var b=0,c=a.length;c>b;b+=1)this.isSVGObject(a[b])&&!this.hasElementBeenProcessed(a[b])&&this.downGradeSVGObject(a[b])},adr.SVGFallback.prototype.isSVGObject=function(a){var b=__imns("util.validation"),c=__imns("util.debug");if(b.isHTMLElement(a)){var d="tagName"in a?a.tagName:" ",e="attributes"in a&&"type"in a.attributes?a.attributes.type:"type"in a?a.type:" ";return"object"===d.toLowerCase()&&"image/svg+xml"===e?!0:!1}(new c.IMDebugger).pass("SVGFallback.isSVGObject: Needs to be supplied a valid HTML Element")},adr.SVGFallback.prototype.hasElementBeenProcessed=function(a){var b=__imns("util.validation"),c=__imns("util.debug");if(b.isHTMLElement(a)){for(var d=!1,e=0,f=this.elementsProcessed.length;f>e;e+=1)if(this.elementsProcessed[e]===a)return d=!0,!0;return d}(new c.IMDebugger).pass("SVGFallback.hasElementBeenProcessed: Needs to be supplied a valid HTML Element")},adr.SVGFallback.prototype.downGradeSVGObject=function(a){this.testAndSetAttribute(a,"classid","image/svg+xml");var b="attributes"in a&&"data"in a.attributes?a.attributes.data:"data"in a?a.data:"";""!==b&&this.testAndSetAttribute(a,"src",b),"attributes"in a&&("data"in a.attributes&&"removeAttribute"in a&&a.removeAttribute("data"),"type"in a&&"removeAttribute"in a&&a.removeAttribute("type")),this.elementsProcessed.push(a)},adr.SVGFallback.prototype.isSVGImage=function(a){var b="tagName"in a?a.tagName:" ",c="src"in a?a.src:" ";return"img"!==b.toLowerCase()||c.lastIndexOf(".svg")!==c.length-4&&c.lastIndexOf(".svgz")!==c.length-5?!1:!0},adr.SVGFallback.prototype.addEventHandler=function(a,b,c){"addEventListener"in a?a.addEventListener(c,b,!0):"attachEvent"in a?(c="on"+c,a.attachEvent(c,b)):(c="on"+c,c in a&&(a[c]=b))},adr.SVGFallback.prototype.svgImageError=function(){this.imageTested=!0,this.imageSupported=!1,this.insertBloatedSVGInclusion()},adr.SVGFallback.prototype.svgImageLoad=function(a){null!==this.imageTimeout&&(clearTimeout(this.imageTimeout),this.imageTimeout=null);var b="naturalWidth"in a&&a.naturalWidth+a.naturalHeight===0?!1:!0,c="width"in a&&a.width+a.height===0?!1:!0;return b||c?(this.ready=!0,this.imageSupported=!0,this.imageTested=!0,void 0):void this.svgImageError()},adr.SVGFallback.prototype.svgImageReadyState=function(a){"readyState"in a&&"complete"===a.readyState?this.svgImageLoad("complete"in a?a:a):this.svgImageError()},adr.SVGFallback.prototype.isSVGImageSupported=function(a){var b=__imns("util.validation");if(this.imageTested)return this.imageSupported;var c=void 0!==a&&b.isHTMLElement(a)&&this.isSVGImage(a)&&"complete"in a?a.complete:"";if(""===c){if(null===this.testImage){this.testImage=new Image;var d=this;this.addEventHandler(this.testImage,function(){d.svgImageError()},"error"),this.addEventHandler(this.testImage,function(){d.svgImageError(d.testImage)},"abort"),this.addEventHandler(this.testImage,function(){d.svgImageLoad(d.testImage)},"load"),this.addEventHandler(this.testImage,function(){d.svgImageReadyState(d.testImage)},"readystatechange"),this.imageTimeout=setTimeout(function(){d.svgImageError()},2e3),this.testImage.src=this.testImageLocation}}else c||(this.imageSupported=!1,this.imageTested=!0,this.processSVGImages())},adr.SVGFallback.prototype.processSVGImages=function(){var a=[];"getElementsByTagName"in document?a=document.getElementsByTagName("img"):document.all&&(a=document.all.tags("IMG"));for(var b=0,c=a.length;c>b;b+=1)this.isSVGImage(a[b])&&!this.hasElementBeenProcessed(a[b])&&this.replaceSVGImage(a[b])},adr.SVGFallback.prototype.testAndSetAttribute=function(a,b,c){var d=!1,e=!1;if(document.all?e=!0:("hasOwnProperty"in a&&(d=!0,e=a.hasOwnProperty(b)?!0:!1),!d&&"attributes"in a&&"getNamedItem"in a.attributes&&(d=!0,e=a.attributes.getNamedItem(b)?!0:!1),!d&&"hasOwnProperty"in a&&(d=!0,e=a.hasOwnProperty(b)?!0:!1),d||(d=!0,e=b in a?!0:!1)),e)if("setAttribute"in a)a.setAttribute(b,c);else if("createAttribute"in document){var f=document.createAttribute(b);f.nodeValue=c,a.setAttributeNode(f)}},adr.SVGFallback.prototype.replaceSVGImage=function(a){var b=__imns("util.validation");if(b.isHTMLElement(a)&&this.isSVGImage(a)){var c="src"in a?a.src:"",d=null;if(d=document.createElement("object",!0),this.testAndSetAttribute(d,"data",c),this.testAndSetAttribute(d,"src",c),document.all&&parseFloat(navigator.appVersion.split("MSIE ")[1])<9&&this.testAndSetAttribute(d,"classid","image/svg+xml"),this.testAndSetAttribute(d,"type","image/svg+xml"),"attributes"in a)for(var e=0,f=a.attributes.length;f>e;e+=1)this.testAndSetAttribute(d,a.attributes[e].nodeName,a.attributes[e].nodeValue);var g=a.parentNode;"offsetWidth"in g&&this.testAndSetAttribute(d,"width",parseFloat(g.offsetWidth)),"offsetHeight"in g&&this.testAndSetAttribute(d,"height",parseFloat(g.offsetHeight));var h=null;h=window.svgweb?window.svgweb.appendChild(d,a.parentNode):a.parentNode.appendChild(d),null!==h&&this.elementsProcessed.push(h),a.parentNode.removeChild(a)}},adr.SVGFallback.prototype.init=function(){var a=__imns("util.tools"),b=this;arguments&&1===arguments.length&&(this.js_libraryPath=null!==arguments[0]?arguments[0]:this.js_libraryPath,window.js_libraryPath=window.js_libraryPath?window.js_libraryPath:this.js_libraryPath,this.js_Path=this.js_libraryPath+"/svg.min.js",this.svg_testPath=this.js_libraryPath+"/spacer.svg",this.testImageLocation=this.svg_testPath);var c=function(){b.isSVGImageSupported(),b.isSVGObjectSupported()};a.fetter(window,"load",[b,c],!0)});