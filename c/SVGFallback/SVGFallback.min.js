"use strict";function SVGFallback(a){return SVGFallback.prototype.singleton?SVGFallback.prototype.singleton:(SVGFallback.prototype.singleton=this,this.js_libraryPath="../../../javascript-library/svgweb/",this.js_Path="../../../javascript-library/svgweb/svg.min.js",this.svg_testPath="../../../javascript-library/svgweb/spacer.svg",this.ready=!1,this.imageSupported=!1,this.imageTested=!1,this.imageTimeout=null,this.objectSupported=!1,this.objectTested=!1,this.elementsProcessed=[],this.testImage=null,this.testImageLocation=this.svg_testPath,this.svgScriptInterval=null,this.svgScriptId="__svgFallback_id_1",void(arguments&&1===arguments.length?this.init(a):this.init()))}SVGFallback.prototype.insertBloatedSVGInclusion=function(){var a=document.getElementsByTagName("head")[0];if(a="getElementsByTagName"in document?document.getElementsByTagName("head")[0]:"all"in document?document.all.tags("HEAD")[0]:null,null!==a&&void 0===findElementByID(this.svgScriptId)){var b=this,c=document.createElement("SCRIPT");c.type="text/javascript",c.id=b.svgScriptId,c.onload=function(){b.loadedSVGInclusion()},c.onerror=function(){null!==b.svgScriptInterval&&clearInterval(this.svgScriptInterval)},c.onreadystatechange=function(){"complete"===this.readyState&&b.checkLoadingSVGInclusion()},c.src=b.js_Path,a.appendChild(c),this.svgScriptInterval=setInterval(function(){b.checkLoadingSVGInclusion()},50);try{"complete"===document.getElementById(this.svgScriptId).readyState&&b.checkLoadingSVGInclusion()}catch(d){}}else void 0!==findElementByID(this.svgScriptId)?this.checkLoadingSVGInclusion():(new IMDebugger).pass("SVGFallback: Document does not have or allow access to the DOM/Head tag.")},SVGFallback.prototype.loadedSVGInclusion=function(){this.ready=!0,this.objectSupported=!0,this.processSVGImages(),null!==this.svgScriptInterval&&clearInterval(this.svgScriptInterval)},SVGFallback.prototype.checkLoadingSVGInclusion=function(){var a=findElementByID(this.svgScriptId);void 0!==a&&isHTMLElement(a)&&"complete"===a.readyState&&this.loadedSVGInclusion()},SVGFallback.prototype.isSVGObjectSupported=function(){return document.all&&parseFloat(navigator.appVersion.split("MSIE ")[1])<9&&!("opera"in window)?(this.processSVGObjectDowngrade(),!1):!0},SVGFallback.prototype.processSVGObjectDowngrade=function(){var a=[];"getElementsByTagName"in document?a=document.getElementsByTagName("object"):document.all&&"tags"in document.all&&(a=document.all.tags("OBJECT"));for(var b=0,c=a.length;c>b;b+=1)this.isSVGObject(a[b])&&!this.hasElementBeenProcessed(a[b])&&this.downGradeSVGObject(a[b])},SVGFallback.prototype.isSVGObject=function(a){if(isHTMLElement(a)){var b="tagName"in a?a.tagName:" ",c="attributes"in a&&"type"in a.attributes?a.attributes.type:"type"in a?a.type:" ";return"object"===b.toLowerCase()&&"image/svg+xml"===c?!0:!1}(new IMDebugger).pass("SVGFallback.isSVGObject: Needs to be supplied a valid HTML Element")},SVGFallback.prototype.hasElementBeenProcessed=function(a){if(isHTMLElement(a)){for(var b=!1,c=0,d=this.elementsProcessed.length;d>c;c+=1)if(this.elementsProcessed[c]===a)return b=!0,!0;return b}(new IMDebugger).pass("SVGFallback.hasElementBeenProcessed: Needs to be supplied a valid HTML Element")},SVGFallback.prototype.downGradeSVGObject=function(a){this.testAndSetAttribute(a,"classid","image/svg+xml");var b="attributes"in a&&"data"in a.attributes?a.attributes.data:"data"in a?a.data:"";""!==b&&this.testAndSetAttribute(a,"src",b),"attributes"in a&&("data"in a.attributes&&"removeAttribute"in a&&a.removeAttribute("data"),"type"in a&&"removeAttribute"in a&&a.removeAttribute("type")),this.elementsProcessed.push(a)},SVGFallback.prototype.isSVGImage=function(a){var b="tagName"in a?a.tagName:" ",c="src"in a?a.src:" ";return"img"!==b.toLowerCase()||c.lastIndexOf(".svg")!==c.length-4&&c.lastIndexOf(".svgz")!==c.length-5?!1:!0},SVGFallback.prototype.addEventHandler=function(a,b,c){"addEventListener"in a?a.addEventListener(c,b,!0):"attachEvent"in a?(c="on"+c,a.attachEvent(c,b)):(c="on"+c,c in a&&(a[c]=b))},SVGFallback.prototype.svgImageError=function(){this.imageTested=!0,this.imageSupported=!1,this.insertBloatedSVGInclusion()},SVGFallback.prototype.svgImageLoad=function(a){null!==this.imageTimeout&&(clearTimeout(this.imageTimeout),this.imageTimeout=null);var b="naturalWidth"in a&&a.naturalWidth+a.naturalHeight===0?!1:!0,c="width"in a&&a.width+a.height===0?!1:!0;return b||c?(this.ready=!0,this.imageSupported=!0,this.imageTested=!0,void 0):void this.svgImageError()},SVGFallback.prototype.svgImageReadyState=function(a){"readyState"in a&&"complete"===a.readyState?this.svgImageLoad("complete"in a?a:a):this.svgImageError()},SVGFallback.prototype.isSVGImageSupported=function(a){if(this.imageTested)return this.imageSupported;var b=void 0!==a&&isHTMLElement(a)&&this.isSVGImage(a)&&"complete"in a?a.complete:"";if(""===b){if(null===this.testImage){this.testImage=new Image;var c=this;this.addEventHandler(this.testImage,function(){c.svgImageError()},"error"),this.addEventHandler(this.testImage,function(){c.svgImageError(c.testImage)},"abort"),this.addEventHandler(this.testImage,function(){c.svgImageLoad(c.testImage)},"load"),this.addEventHandler(this.testImage,function(){c.svgImageReadyState(c.testImage)},"readystatechange"),this.imageTimeout=setTimeout(function(){c.svgImageError()},2e3),this.testImage.src=this.testImageLocation}}else b||(this.imageSupported=!1,this.imageTested=!0,this.processSVGImages())},SVGFallback.prototype.processSVGImages=function(){var a=[];"getElementsByTagName"in document?a=document.getElementsByTagName("img"):document.all&&(a=document.all.tags("IMG"));for(var b=0,c=a.length;c>b;b+=1)this.isSVGImage(a[b])&&!this.hasElementBeenProcessed(a[b])&&this.replaceSVGImage(a[b])},SVGFallback.prototype.testAndSetAttribute=function(a,b,c){var d=!1,e=!1;if(document.all?e=!0:("hasOwnProperty"in a&&(d=!0,e=a.hasOwnProperty(b)?!0:!1),!d&&"attributes"in a&&"getNamedItem"in a.attributes&&(d=!0,e=a.attributes.getNamedItem(b)?!0:!1),!d&&"hasOwnProperty"in a&&(d=!0,e=a.hasOwnProperty(b)?!0:!1),d||(d=!0,e=b in a?!0:!1)),e)if("setAttribute"in a)a.setAttribute(b,c);else if("createAttribute"in document){var f=document.createAttribute(b);f.nodeValue=c,a.setAttributeNode(f)}},SVGFallback.prototype.replaceSVGImage=function(a){if(isHTMLElement(a)&&this.isSVGImage(a)){var b="src"in a?a.src:"",c=null;if(c=document.createElement("object",!0),this.testAndSetAttribute(c,"data",b),this.testAndSetAttribute(c,"src",b),document.all&&parseFloat(navigator.appVersion.split("MSIE ")[1])<9&&this.testAndSetAttribute(c,"classid","image/svg+xml"),this.testAndSetAttribute(c,"type","image/svg+xml"),"attributes"in a)for(var d=0,e=a.attributes.length;e>d;d+=1)this.testAndSetAttribute(c,a.attributes[d].nodeName,a.attributes[d].nodeValue);var f=a.parentNode;"offsetWidth"in f&&this.testAndSetAttribute(c,"width",parseFloat(f.offsetWidth)),"offsetHeight"in f&&this.testAndSetAttribute(c,"height",parseFloat(f.offsetHeight));var g=null;g=window.svgweb?window.svgweb.appendChild(c,a.parentNode):a.parentNode.appendChild(c),null!==g&&this.elementsProcessed.push(g),a.parentNode.removeChild(a)}},SVGFallback.prototype.init=function(){var a=this;arguments&&1===arguments.length&&(this.js_libraryPath=null!==arguments[0]?arguments[0]:this.js_libraryPath,window.js_libraryPath=window.js_libraryPath?window.js_libraryPath:this.js_libraryPath,this.js_Path=this.js_libraryPath+"/svg.min.js",this.svg_testPath=this.js_libraryPath+"/spacer.svg",this.testImageLocation=this.svg_testPath);var b=function(){a.isSVGImageSupported(),a.isSVGObjectSupported()};fetter(window,"load",b,!0)};