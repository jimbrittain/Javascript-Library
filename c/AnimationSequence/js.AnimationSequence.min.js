"use strict";function AnimationSequence(){this.onStep=-1,this.steps=[],this.active=!1,this.playing=!1}function AnimationSequenceStep(){this.name="",this.start=-1,this.end=-1,this.animations=[]}function Timer(){this._intervalID=-1,this._timestart=0,this._reserve=0,this._running=!1,this.interval=Math.floor(1e3/24)}function parseTimeToMS(a){var b=/(([0-9]+(?:\.[0-9]+){0,1}(?:\ ){0,1}ms)|([0-9]+(?:\.[0-9]+){0,1}(?:\ ){0,1}s)|([0-9]+(?:\.[0-9]+){0,1}(?:\ ){0,1}h)|([0-9]+(?:\.[0-9]+){0,1}(?:\ ){0,1}m)|([0-9]+(?:\.[0-9]+){0,1}(?:\ ){0,1}d)|([0-9]+(?:\.[0-9]+){0,1}(?:\ ){0,1}fps))/g,c=[];if(isNumber(a));else c=a.match(b)}AnimationSequence.prototype.addStep=function(a){this.steps.push(new AnimationSequenceStep),a instanceof Animation&&this.addAnimation(a)},AnimationSequence.prototype.addAnimation=function(a){a instanceof Animation&&this.lastAddedStep(!0).addAnimation(a)},AnimationSequence.prototype.lastAddedStep=function(a){return this.steps.length<1?void 0!==a&&a===!0?(this.steps.push(new AnimationSequenceStep),this.steps[0]):null:this.steps[this.steps.length-1]},AnimationSequence.prototype.findStepId=function(a){var b=0,c=this.steps.length;if(a instanceof AnimationSequenceStep){for(b=0,c=this.steps.length;c>b;b+=1)if(a===this.steps[b])return b}else{if(isNumber(a)&&Math.round(a)&&a>0&&a<this.steps.length)return b;if("string"==typeof a&&a.length>0)for(b=0,c=this.steps.length;c>b;b+=1)if(a===this.steps[b].name)return b}return-1},AnimationSequence.prototype.findStep=function(a){var b=this.findStepId(a);return-1!==b?this.steps[b]:void 0},AnimationSequence.prototype.currentStep=function(){return-1!==this.onStep&&this.onStep>-1&&this.onStep<this.steps.length?this.findStep(this.onStep):this.lastAddedStep(!0)},AnimationSequence.prototype.nextStepId=function(){var a=this.onStep+1;return a<this.steps.length?a:void 0},AnimationSequence.prototype.previousStepId=function(){var a=this.onStep-1;return a>-1?a:void 0},AnimationSequence.prototype.nextStep=function(){var a=this.nextStepId();return void 0!==a?this.steps[a]:null},AnimationSequence.prototype.previousStep=function(){var a=this.previousStepId();return void 0!==a?this.steps[a]:null},AnimationSequence.prototype.goToPreviousStep=function(){var a=this.previousStepId();void 0!==a&&this.goToStep(a,"auto")},AnimationSequence.prototype.goToNextStep=function(){var a=this.nextStepId();void 0!==a&&this.goToStep(a,"auto")},AnimationSequence.prototype.goToStep=function(a,b){if(void 0!==this.findStep(a)){switch(this.steps[this.onStep].stop(),this.onStep=this.findStepId(a),b){case"play":case"run":this.currentStep().play();break;case"stop":case"end":this.currentStep().stop();break;case"auto":case"":this.playing&&this.currentStep().play()}return!0}return!1},AnimationSequence.prototype.play=function(){this.start(),this.currentStep().play()},AnimationSequence.prototype.start=function(){this.timer().go()},AnimationSequenceStep.prototype.setStartTime=function(){},Timer.prototype.start=function(){this._timestart=(new Date).getTime(),this.startInterval()},Timer.prototype.go=Timer.prototype.start,Timer.prototype.end=function(){this._reserve+=this.elasped(),this.stopInterval(),this._timestart=0},Timer.prototype.stop=Timer.prototype.end,Timer.prototype.pause=function(){this._running?this.end():this.start()},Timer.prototype.elapsed=function(){var a=(new Date).getTime();return a>this.getStart()?a-this.getStart():0},Timer.prototype.getStart=function(){return 0===this._timestart?(new Date).getTime():this._timestart()},Timer.prototype.addListener=function(a){if(isFunction(a)){for(var b=0,c=this.listeners.length;c>b;b+=1)if(this.listeners[b]===a)return!1;return this.listeners.push(a),!0}return!1},Timer.prototype.removeListener=function(a){var b=-1;if(isNumber(a)&&Math.floor(a)===a&&a>-1&&a<this.listeners.length)b=a;else if(isFunction(a))for(var c=0,d=this.listeners.length;d>c;c+=1)if(a===this.listeners[c]){b=c;break}return-1!==b?(this.listeners.splice(b,1),!0):!1},Timer.prototype.setInterval=function(a){var b=parseTimeToMS(a);isNumber(b)&&(this.interval=b)},Timer.prototype.startInterval=function(){this.stopInterval();var a=this;this._running=!0,this._intervalID=setInterval(a.clicker,this.interval)},Timer.prototype.stopInterval=function(){-1===this._intervalID&&(clearInterval(this._intervalID),this._running=!1,this._intervalID=-1)},Timer.prototype.clicker=function(){if(this.listeners.length>0){var a,b,c=this,d=this._reserve+this.elapsed();for(a=0,b=this.listeners.length;b>a;a+=1)try{this.listeners[a](d)}catch(e){c.removeListener(a)}}};