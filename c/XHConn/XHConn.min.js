"use strict";function XHConn(){if(void 0!==XHConn.prototype.singleton)return XHConn.prototype.xhconnTried&&XHConn.prototype.xhconnFailed?!1:XHConn.prototype.singleton;XHConn.prototype.singleton=this,XHConn.prototype.xhconnTried=!0,XHConn.prototype.xhconnFailed=!1,XHConn.prototype.oldOpera=!1;var a,b=!1;if(void 0!==typeof XMLHttpRequest)try{a=new XMLHttpRequest}catch(c){a=!1}else if(void 0!==typeof ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){a=!1}}if(!a)if("opera"in window&&!window.XMLHttpRequest){XHConn.prototype.oldOpera=!0,this.oldOperaBuild();try{a=new window.XMLHttpRequest}catch(c){a=!1}a||(XHConn.prototype.xhconnFailed=!0)}else XHConn.prototype.xhconnFailed=!0;return this.s_connect=function(c,d,e,f){if(!a)return!1;b=!1,d=d.toUpperCase();try{if("GET"===d)a.open(d,c+"?"+e,!0),e="";else{if(XHConn.prototype.oldOpera)return!1;a.open(d,c,!0),a.setRequestHeader("Method","POST "+c+" HTTP/1.1"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}a.onreadystatechange=function(){4!==a.readyState||b||(b=!0,f(a))},a.send(e)}catch(g){return!1}return!0},this}XHConn.prototype.connect=function(a,b,c,d){XHConn.prototype.oldOpera?this.o_connect(a,b,c,d):this.s_connect(a,b,c,d)},XHConn.prototype.oldOperaBuild=function(){window.XMLHttpRequest=function(){this.readyState=0,this.status=0,this.statusText="",this._headers=[],this._aborted=!1,this._async=!0,this._defaultCharset="ISO-8859-1",this._getCharset=function(){var a=this._defaultCharset,b=this.getResponseHeader("Content-type").toUpperCase(),c=b.indexOf("CHARSET=");return-1!==c&&(a=b.substring(c)),c=a.indexOf(";"),-1!==c&&(a=a.substring(0,c)),c=a.indexOf(","),-1!==c&&(a=a.substring(0,c)),a},this.abort=function(){this._aborted=!0},this.getAllResponseHeaders=function(){return this.getAllResponseHeader("*")},this.getAllResponseHeader=function(a){for(var b="",c=0,d=this._headers.length;d>c;c+=1)("*"===a||this._headers[c].h===a)&&(b+=this._headers[c].h+": "+this._headers[c].v+"\n");return b},this.getResponseHeader=function(a){var b=this.getAllResponseHeader(a),c=b.indexOf("\n");return-1!==c&&(b=b.substring(0,c)),b},this.setRequestHeader=function(a,b){this._headers[this._headers.length]={h:a,v:b}},this.open=function(a,b,c){this.method=a,this.url=b,this._async=!0,this._aborted=!1,this._headers=[],arguments.length>=3&&(this._async=c),arguments.length>3&&window.opera.postError("XMLHttpRequest.open() - user/password not supported"),this.readyState=1,this.onreadystatechange&&this.onreadystatechange()},this.send=function(a){return navigator.javaEnabled()?void(this._async?setTimeout(this._sendasync,0,this,a):this._sendsync(a)):void this.abort()},this._sendasync=function(a,b){a._aborted||a._sendsync(b)},this._sendsync=function(a){this.readyState=2,this.onreadystatechange&&this.onreadystatechange();for(var b=new java.net.URL(new java.net.URL(window.location.href),this.url),c=b.openConnection(),d=0,e=this._headers.length;e>d;d+=1)c.setRequestProperty(this._headers[d].h,this._headers[d].v);if(this._headers=[],"POST"===this.method){c.setDoOutput(!0);var f=new java.io.OutputStreamWriter(c.getOutputStream(),this._getCharset());f.write(a),f.flush(),f.close()}var g=!1,h=!1,i=!1,j=!1,k=!1,l=!1;for(d=0;;d+=1){var m=c.getHeaderFieldKey(d),n=c.getHeaderField(d);if(null===m&&null===n)break;if(null!==m)switch(this._headers[this._headers.length]={h:m,v:n},m.toLowerCase()){case"content-encoding":g=!0;break;case"content-length":h=!0;break;case"content-type":i=!0;break;case"date":j=!0;break;case"expires":k=!0;break;case"last-modified":l=!0}}var o;o=c.getContentEncoding(),null===o||g||(this._headers[this._headers.length]={h:"Content-encoding",v:o}),o=c.getContentLength(),-1===o||h||(this._headers[this._headers.length]={h:"Content-length",v:o}),o=c.getContentType(),null===o||i||(this._headers[this._headers.length]={h:"Content-type",v:o}),o=c.getDate(),0===o||j||(this._headers[this._headers.length]={h:"Date",v:new Date(o).toUTCString()}),o=c.getExpiration(),0===o||k||(this._headers[this._headers.length]={h:"Expires",v:new Date(o).toUTCString()}),o=c.getLastModified(),0===o||l||(this._headers[this._headers.length]={h:"Last-modified",v:new Date(o).toUTCString()});var p="",q=c.getInputStream();if(q){for(var r,s=new java.io.BufferedReader(new java.io.InputStreamReader(q,this._getCharset()));null!==(r=s.readLine());)2===this.readyState&&(this.readyState=3,this.onreadystatechange&&this.onreadystatechange()),p+=r+"\n";s.close(),this.status=200,this.statusText="OK",this.responseText=p,this.readyState=4,this.onreadystatechange&&this.onreadystatechange(),this.onload&&this.onload()}else this.status=404,this.statusText="Not Found",this.responseText="",this.readyState=4,this.onreadystatechange&&this.onreadystatechange(),this.onerror&&this.onerror()}}};