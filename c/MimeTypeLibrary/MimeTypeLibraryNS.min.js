"use strict";var adr=__imns("component.classes");if(!("MimeTypeLibrary"in adr)){adr.MimeTypeReference=function(a,b){this.mimetype=a,this.handlers=[],this.exists=!1,this.checked=!1,this.addHandler(b)},adr.MimeTypeReference.prototype.__addSingleHandler=function(a){for(var b=!0,c=0,d=this.handlers.length;d>c;c+=1)if(this.handlers[c]===a){b=!1;break}return b?(this.handlers.push(a),!0):!1},adr.MimeTypeReference.prototype.addHandler=function(a){var b=__imns("util.validation");if(b.isArray(a)||"string"!=typeof a||(a=[a]),b.isArray(a)){for(var c=!1,d=0,e=a.length;e>d;d+=1){var f=this.__addSingleHandler(a[d]);c=f?!0:c}return c}return!1},adr.MimeTypeReference.prototype.canNativeCheck=function(){return"mimeTypes"in navigator&&navigator.mimeTypes.length>0},adr.MimeTypeReference.prototype.check=function(){if(this.canNativeCheck()&&void 0!==navigator.mimeTypes[this.mimetype]){var a=navigator.mimeTypes[this.mimetype];if("enabledPlugin"in a&&a.enabledPlugin)return this.exists(),!0;this.checked=!0}},adr.MimeTypeReference.prototype.confirmed=function(){this.checked||(this.exists=!0,this.checked=!0)},adr.MimeTypeCollection=function(){var a=__imns("component.classes");return void 0!==a.MimeTypeCollection.prototype.singleton?a.MimeTypeCollection.prototype.singleton:(a.MimeTypeCollection.prototype.singleton=this,void(this.references=[]))},adr.MimeTypeCollection.prototype.add=function(a,b){for(var c=this.references.length,d=__imns("component.classes");c>0;)if(c-=1,this.references[c].mimetype===a)return this.references[c].addHandler(b);var e=new d.MimeTypeReference(a,b);return this.references.push(e),!0},adr.MimeTypeCollection.prototype.find=function(a){for(var b=this.references.length;b>0;)if(b-=1,this.references[b].mimetype===a)return this.references[b];return null},adr.MimeTypeCollection.prototype.findHandlersForMimeType=function(a){var b=this.find(a),c=__imns("component.classes");return b instanceof c.MimeTypeReference?b.handlers:[]},adr.MimeTypeCollection.prototype.exists=function(a,b){b=void 0===b||b!==!1?!0:!1;for(var c=this.references.length,d=__imns("component.classes"),e=new d.ActiveXCollection,f=!1;c>0;)if(c-=1,this.references[c].mimetype===a&&(f=!0,this.references[c].confirmed(),b))for(var g=0,h=this.references[c].handlers.length;h>g;g+=1)e.exists(this.references[c].handlers[g],!1);return f},adr.FileExtensionReference=function(a,b){return this.extension="string"==typeof a&&a.length>1&&a.length<5?a.toLowerCase():void 0,this.mimetype="string"==typeof b?b:void 0,null===this.extension||null===this.mimetype?void 0:void 0},adr.FileExtensionCollection=function(){var a=__imns("component.classes");return void 0!==a.FileExtensionCollection.prototype.singleton?a.FileExtensionCollection.prototype.singleton:(a.FileExtensionCollection.prototype.singleton=this,void(this.references=[]))},adr.FileExtensionCollection.prototype.add=function(a,b){var c=__imns("component.classes");if(null===this.findMimeTypeForFileExtension(a)){var d=new c.FileExtensionReference(a,b);if(d instanceof c.FileExtensionReference)return this.references.push(d),!0}return!1},adr.FileExtensionCollection.prototype.findExtensionsForMimeType=function(a){for(var b=this.references.length,c=[];b>0;)b-=1,this.references[b].mimetype===a&&c.push(this.references[b].extension);return c},adr.FileExtensionCollection.prototype.findMimeTypeForFileExtension=function(a){for(var b=this.references.length;b>0;)if(b-=1,this.references[b].extension===a)return this.references[b].mimetype;return null},adr.ActiveXReference=function(a,b){this.handler=a,this.mimetypes=[],this.exists=!1,this.checked=!1,void 0!==b&&this.addMimeType(b)},adr.ActiveXReference.prototype.exists=function(){var a=__imns("util.tools");return this.checked||(this.exists=a.vbsPluginCheck(this.handler),this.checked=!0),this.exists},adr.ActiveXReference.prototype.confirmed=function(){this.checked||(this.exists=!0,this.checked=!0)},adr.ActiveXReference.prototype.__addSingleMimeType=function(a){for(var b=!0,c=0,d=this.mimetypes.length;d>c;c+=1)if(this.mimetypes[c]===a){b=!1;break}return b?(this.mimetypes.push(a),!0):!1},adr.ActiveXReference.prototype.addMimeType=function(a){var b=__imns("util.validation");if(a=b.isArray(a)||"string"!=typeof a?a:[a],b.isArray(a)){for(var c=!1,d=0,e=a.length;e>d;d+=1){var f=this.__addSingleMimeType(a[d]);c=f?!0:c}return c}return!1},adr.ActiveXCollection=function(){var a=__imns("component.classes");return void 0!==a.ActiveXCollection.prototype.singleton?a.ActiveXCollection.prototype.singleton:(a.ActiveXCollection.prototype.singleton=this,void(this.references=[]))},adr.ActiveXCollection.prototype.findHandlersFromMimeType=function(a){for(var b=this.references.length,c=[];b>0;)b-=1,this.references[b].hasType(a)&&c.push(this.references[b].handler);return c},adr.ActiveXCollection.prototype.findHandler=function(a){for(var b=this.references.length,c=__imns("component.classes");b>0;)if(b-=1,this.references[b].handler===a)return this.references[b];var d=new c.ActiveXReference(a);return this.references.push(d),this.references[this.references.length-1]},adr.ActiveXCollection.prototype.add=function(a,b){var c=this.findHandler(a);return c.addMimeType(b)},adr.ActiveXCollection.prototype.exists=function(a,b){b=void 0===b||b!==!1?!0:!1;for(var c=this.references.length,d=__imns("component.classes"),e=new d.MimeTypeCollection,f=!1;c>0;)if(c-=1,this.references[c].handler===a&&(this.references[c].confirmed(),f=!0,b))for(var g=0,h=this.references[c].mimetypes.length;h>g;g+=1)e.exists(this.references[c].mimetypes[g],!1);return f},adr.MimeTypeLibrary=function(){var a=__imns("component.classes");return void 0!==a.MimeTypeLibrary.prototype.singleton?a.MimeTypeLibrary.prototype.singleton:(a.MimeTypeLibrary.prototype.singleton=this,this.extensionlibrary=new a.FileExtensionCollection,this.handlerlibrary=new a.ActiveXCollection,void(this.mimelibrary=new a.MimeTypeCollection))},adr.MimeTypeLibrary.prototype.addFileExtensionReference=function(a,b){__imns("component.classes");return this.extensionlibrary.add(a,b)},adr.MimeTypeLibrary.prototype.determineExtensionFromFileName=function(a){var b=__imns("util.tools");return b.findExtensionFromFilename(a)},adr.MimeTypeLibrary.prototype.determineMimeTypeFromFileName=function(a){var b=this.determineExtensionFromFileName(a);return this.extensionlibrary.findMimeTypeForFileExtension(b)},adr.MimeTypeLibrary.prototype.addMimeReference=function(a,b,c){return void 0!==c&&this.extensionlibrary.add(c,a),this.handlerlibrary.add(b,a),this.mimelibrary.add(a,b)},adr.MimeTypeLibrary.prototype.addMultipleMimeReferences=function(a){var b=__imns("util.validation");if(b.isArray(a))for(var c=0,d=a.length;d>c;c+=1)b.isArray(a[c])&&(3===a[c].length?this.addMimeReference(a[c][0],a[c][1],a[c][2]):2===a[c].length&&this.addMimeReference(a[c][0],a[c][1]))},adr.MimeTypeLibrary.prototype.addFileExtensionReference=function(a,b,c){return void 0!==c&&(this._addCOMReference(c,b),this.mimelibrary.add(b,c)),this.extensionlibrary.add(a,b)},adr.MimeTypeLibrary.prototype.addCOMReference=function(a,b,c){return void 0!==c&&this.extensionlibrary.add(c,b),this.mimelibrary.add(b,a),this.handlerlibrary.add(a,b)},adr.MimeTypeLibrary.prototype.addActiveXReference=adr.MimeTypeLibrary.prototype.addCOMReference,adr.MimeTypeLibrary.prototype.mimeExists=function(a){return this.mimelibrary.exists(a)},adr.MimeTypeLibrary.prototype.comExists=function(a){return this.handlerlibrary.exists(a)},adr.MimeTypeLibrary.prototype.checkPluginByMimeType=function(a){var b=__imns("util.tools"),c=__imns("component.classes"),d=this.mimelibrary.find(a);if(d instanceof c.MimeTypeReference){if(d.checked)return d.exists;if(d.canNativeCheck())return d.check(),d.exists();if(void 0!==window.vbsActive&&window.vbsActive){for(var e=this.mimelibrary.findHandlers(a),f=!1,g=0,h=e.length;h>g;g+=1){var i=b.vbsPluginCheck(e[g]);i&&(this.comExists(e[g]),f=!0)}return f}}return!1};var ut=__imns("util.tools");ut.determineMimeTypeFromFileExtension=function(a){var b=__imns("component.classes");return(new b.MimeTypeLibrary).determineMimeTypeFromFileExtension(a)},(new adr.MimeTypeLibrary).addMultipleMimeReferences([["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.2","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.3","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.4","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.5","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.6","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.7","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.8","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.9","swf"],["application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash.10","swf"],["application/x-shockwave-flash","Flash10e.ocx","swf"],["application/x-shockwave-flash","Flash9.ocx","swf"],["application/x-shockwave-flash","Flash8.ocx","swf"],["application/x-shockwave-flash","Flash.ocx","swf"],["application/futuresplash","ShockwaveFlash.ShockwaveFlash","spl"],["application/pdf","PDF.PdfCtrl.1","pdf"],["application/pdf","AcroExch.Document","pdf"],["application/pdf","AcroIEHelper.ocx","pdf"],["application/x-ms-wmz","WMPlayer.OCX","wmz"],["application/x-ms-wmz","MediaPlayer.MediaPlayer.1","wmz"],["application/x-ms-wmz","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wmz"],["application/x-ms-wmz","rmocx.RealPlayer G2 Control","wmz"],["application/x-ms-wmd","WMPlayer.OCX","wmd"],["application/x-ms-wmd","MediaPlayer.MediaPlayer.1","wmd"],["application/x-ms-wmd","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wmd"],["application/x-ms-wmd","rmocx.RealPlayer G2 Control","wmd"],["application/x-silverlight","Windows.XamlDocument","xaml"],["application/mp4","QuickTimeCheckObject.QuickTimeCheck.1","mp4"],["application/mp4","QuickTime.QuickTime.4","mp4"],["application/mp4","QuickTime.QuickTime","mp4"],["application/x-ms-xbap","Windows.Xbap","mp4"],["application/xaml+xml","Windows.XamlDocument","xaml"],["video/x-ms-wmv","WMPlayer.OCX","wmv"],["video/x-ms-wmv","MediaPlayer.MediaPlayer.1","wmv"],["video/x-ms-wmv","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wmv"],["video/x-ms-wmv","rmocx.RealPlayer G2 Control","wmv"],["video/x-ms-asf","WMPlayer.OCX","asf"],["video/x-ms-asf","MediaPlayer.MediaPlayer.1","asf"],["video/x-ms-asf","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","asf"],["video/x-ms-asf","rmocx.RealPlayer G2 Control","asf"],["video/x-ms-wma","WMPlayer.OCX","wma"],["video/x-ms-wma","MediaPlayer.MediaPlayer.1","wma"],["video/x-ms-wma","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wma"],["video/x-ms-wma","rmocx.RealPlayer G2 Control","wma"],["video/x-ms-wax","WMPlayer.OCX","wax"],["video/x-ms-wax","MediaPlayer.MediaPlayer.1","wax"],["video/x-ms-wax","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wax"],["video/x-ms-wax","rmocx.RealPlayer G2 Control","wax"],["video/x-ms-wvx","WMPlayer.OCX","wvx"],["video/x-ms-wvx","MediaPlayer.MediaPlayer.1","wvx"],["video/x-ms-wvx","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wvx"],["video/x-ms-wvx","rmocx.RealPlayer G2 Control","wvx"],["video/quicktime","QuickTimeCheckObject.QuickTimeCheck.1","mov"],["video/quicktime","QuickTime.QuickTime.4","mov"],["video/quicktime","QuickTime.QuickTime","mov"],["video/mpeg","WMPlayer.OCX","mpeg"],["video/mpeg","MediaPlayer.MediaPlayer.1","mpg"],["video/mpeg","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","mpg"],["video/mpeg","rmocx.RealPlayer G2 Control","mpg"],["video/mpeg","QuickTimeCheckObject.QuickTimeCheck.1","mpg"],["video/mpeg","QuickTime.QuickTime.4","mpg"],["video/mpeg","QuickTime.QuickTime","mpg"],["video/mp4","QuickTimeCheckObject.QuickTimeCheck.1","mpg"],["video/mp4","QuickTime.QuickTime.4","mp4"],["video/mp4","QuickTime.QuickTime","mp4"],["video/x-msvideo","WMPlayer.OCX","wmv"],["video/x-msvideo","MediaPlayer.MediaPlayer.1","wmv"],["audio/x-pn-realaudio-plugin","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","rm"],["audio/x-pn-realaudio-plugin","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","ra"],["audio/mpeg","WMPlayer.OCX","aac"],["audio/mpeg","MediaPlayer.MediaPlayer.1","aac"],["audio/mpeg","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","aac"],["audio/mpeg","rmocx.RealPlayer G2 Control","aac"],["audio/mpeg","QuickTimeCheckObject.QuickTimeCheck.1","aac"],["audio/mpeg","QuickTime.QuickTime.4","aac"],["audio/mpeg","QuickTime.QuickTime","aac"],["audio/mp3","WMPlayer.OCX","mp3"],["audio/mp3","MediaPlayer.MediaPlayer.1","mp3"],["audio/mp3","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","mp3"],["audio/mp3","rmocx.RealPlayer G2 Control","mp3"],["audio/mp3","QuickTimeCheckObject.QuickTimeCheck.1","mp3"],["audio/mp3","QuickTime.QuickTime.4","mp3"],["audio/mp3","QuickTime.QuickTime","mp3"],["audio/x-wav","WMPlayer.OCX","wav"],["audio/x-wav","MediaPlayer.MediaPlayer.1","wav"],["audio/x-wav","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","wav"],["audio/x-wav","rmocx.RealPlayer G2 Control","wav"],["audio/mp4","QuickTimeCheckObject.QuickTimeCheck.1","m4a"],["audio/mp4","QuickTime.QuickTime.4","m4a"],["audio/mp4","QuickTime.QuickTime","m4a"],["audio/opus","WMPlayer.OCX","opus"],["audio/opus","QuickTime.QuickTime","opus"],["audio/opus","QuickTime.QuickTime.4","opus"],["audio/ogg","WMPlayer.OCX","ogg"],["audio/ogg","QuickTime.QuickTime","ogg"],["audio/ogg","QuickTime.QuickTime.4","ogg"],["audio/ogg","WMPlayer.OCX","oga"],["audio/ogg","QuickTime.QuickTime","oga"],["audio/ogg","QuickTime.QuickTime.4","oga"],["audio/x-flac","QuickTime.QuickTime.4","flac"],["image/x-quicktime","QuickTimeCheckObject.QuickTimeCheck.1",""],["image/x-quicktime","QuickTime.QuickTime.4",""],["image/x-quicktime","QuickTime.QuickTime",""],["image/svg+xml","Adobe.SVGCtl",""]])}